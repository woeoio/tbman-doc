<!DOCTYPE html>

<html lang="zh-CN"  class="">


<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="keywords" content="VB6/VBA, WebView2浏览器控件, 可做采集">
    
    
    <meta name="description" content="VB6/VBA可用的WebView2浏览器控件(可做采集)">
    
    <meta name="generator" content="teedoc">
    <meta name="theme" content="teedoc-plugin-theme-default">
    
        
        <meta name="markdown-generator" content="teedoc-plugin-markdown-parser">
        
        <script>
MathJax = {"loader": {"load": ["output/svg"]}, "tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]]}, "svg": {"fontCache": "global"}};
</script>
        
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
        <script src="/static/js/theme_default/pre_main.js"></script>
        
        <link rel="stylesheet" href="/static/css/theme_default/prism.min.css" type="text/css"/>
        
        <link rel="stylesheet" href="/static/css/theme_default/viewer.min.css" type="text/css"/>
        
        <link rel="stylesheet" href="/static/css/theme_default/dark.css" type="text/css"/>
        
        <link rel="stylesheet" href="/static/css/theme_default/light.css" type="text/css"/>
        
        <script src="/static/js/theme_default/jquery.min.js"></script>
        
        <script src="/static/js/theme_default/split.js"></script>
        
        <link rel="stylesheet" href="/static/css/search/style.css" type="text/css"/>
        
        <link rel="stylesheet" href="/static/css/custom.css" type="text/css"/>
        
    
    
    <title>其他功能 - 开发手册 | twinbasic.com.cn</title>
    
    <script type="text/javascript">js_vars = {}</script>
    <script type="text/javascript">metadata = {"tags": [], "date": false, "update": [], "ts": 0, "author": "", "brief": "", "cover": ""}</script>
</head>


<body class="type_doc">
    
    <div id="navbar">
        <div id="navbar_menu">
            <a class="site_title" href="/">
                
                
                    <h2>开发手册</h2>
                
        </a>
            <a id="navbar_menu_btn"></a>
        </div>
        <div id="navbar_items">
            <div>
                <ul id="nav_left">
<li class=""><a  href="/twinbasic/">twinbasic</a></li>
<li class="active"><a  href="/tbman/">tbman</a></li>
<li class=""><a  href="/vb6/">VB6(勇芳整理)</a></li>
</ul>

            </div>
            <div>
                <ul id="nav_right">
<li class=""><a target="_blank" href="https://twinbasic.com.cn">首页</a></li>
</ul>

                <ul class="nav_plugins"><li><a id="themes" class="light"></a></li></ul><ul class="nav_plugins"><li><a id="search"><span class="icon"></span><span class="placeholder">搜索</span>
                            <div id="search_hints">
                                <span id="search_input_hint">输入关键词，多关键词空格隔开</span>
                                <span id="search_loading_hint">正在加载，请稍候。。。</span>
                                <span id="search_download_err_hint">下载文件失败，请刷新重试或检查网络</span>
                                <span id="search_other_docs_result_hint">来自其它文档的结果</span>
                                <span id="search_curr_doc_result_hint">当前文档搜索结果</span>
                            </div></a></li></ul>
            </div>
        </div>
    </div>
    
    <div id="wrapper">
        <div id="sidebar_wrapper">
            <div id="sidebar">
                <div id="sidebar_title">
                    
                </div>
                <ul class="">
<li class="not_active no_link sidebar_category"><span class="label">简介</span></li>
<li class="not_active with_link"><a href="/tbman/index.html"><span class="label">欢迎使用</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/tbman/start/Install.html"><span class="label">安装指引</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/tbman/start/KnownIssues.html"><span class="label">已知问题</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/tbman/start/ChangeLog.html"><span class="label">更新日志</span><span class=""></span></a></li>
<li class="not_active no_link sidebar_category"><span class="label">开发</span></li>
<li class="not_active with_link"><a href="/tbman/dev/hello.html"><span class="label">快速入门</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/tbman/dev/more.html"><span class="label">更多...</span><span class=""></span></a></li>
<li class="not_active no_link sidebar_category"><span class="label">关于</span></li>
<li class="not_active with_link"><a href="/tbman/about/Collaboration.html"><span class="label">协作</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/tbman/about/OfThanks.html"><span class="label">致谢</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/tbman/about/Donate.html"><span class="label">捐赠</span><span class=""></span></a></li>
</ul>

            </div>
        </div>
        <div id="article">
            <div id="menu_wrapper">
                <div id="menu">
                </div>
            </div>
            <div id="content_wrapper">
                <div id="content_body">
                    <div id="article_head">
                        <div id="article_title">
                            
                            <h1>其他功能</h1>
                            
                        </div>
                        <div id="article_tags">
                            <ul>
                            
                            </ul>
                        </div>
                        <div id="article_info">
                        <div id="article_info_left">
                            <span class="article_author">
                                
                            </span>
                            
                        </div>
                        <div id="article_info_right">
                            
                        </div>
                        </div>
                    </div>
                    <div id="article_tools">
                        <span></span>
                        <span id="toc_btn"></span>
                    </div>
                    <div id="update_history">
                        
                    </div>
                    <div id="article_content">
                        
                            <p>非常感谢你的耐心！我们已完成了大部分文档内容。接下来是 <strong>总结与其他功能部分 (Summary &amp; Other Features)</strong> 的文档内容。</p>
<hr />
<h3 id="%3Cstrong%3E%E6%80%BB%E7%BB%93%E4%B8%8E%E5%85%B6%E4%BB%96%E5%8A%9F%E8%83%BD%E9%83%A8%E5%88%86-%28Summary-%26amp%3B-Other-Features%29%3C/strong%3E"><strong>总结与其他功能部分 (Summary &amp; Other Features)</strong></h3>
<h4 id="%3Cstrong%3E1.-UserContextMenu%3C/strong%3E"><strong>1. UserContextMenu</strong></h4>
<ul>
<li><strong>功能说明</strong>：当用户右击 WebView2 控件时触发该事件。如果禁用了默认上下文菜单 (<code>AreDefaultContextMenusEnabled = False</code>)，则可以通过此事件自定义右键菜单。</li>
<li><strong>参数</strong>：<ul>
<li><code>X</code> (Single)：右键点击时的 X 坐标。</li>
<li><code>Y</code> (Single)：右键点击时的 Y 坐标。</li>
</ul>
</li>
<li><strong>示例代码</strong>：
<pre class="language-php"><code class="language-php">Private Sub WebView21_UserContextMenu(X As Single, Y As Single)
    MsgBox &quot;用户右键点击位置：X=&quot; &amp; X &amp; &quot;, Y=&quot; &amp; Y
End Sub
</code></pre>
</li>
</ul>
<hr />
<h4 id="%3Cstrong%3E2.-ScriptDialogOpening%3C/strong%3E"><strong>2. ScriptDialogOpening</strong></h4>
<ul>
<li><strong>功能说明</strong>：当 <code>AreDefaultScriptDialogsEnabled</code> 设置为 <code>False</code> 时，JavaScript 中的 <code>alert()</code>, <code>confirm()</code>, <code>prompt()</code> 等默认对话框会被拦截，并触发该事件。可以通过此事件自定义对话框。</li>
<li><strong>参数</strong>：<ul>
<li><code>ScriptDialogKind</code> (wv2ScriptDialogKind)：脚本对话框的类型（如 <code>alert</code>、<code>confirm</code> 等）。</li>
<li><code>Accept</code> (ByRef Boolean)：设置为 <code>True</code> 可接受对话框，<code>False</code> 可拒绝对话框。</li>
<li><code>ResultText</code> (String)：用于接收用户输入的文本。</li>
<li><code>URI</code> (String)：触发对话框的 URL。</li>
<li><code>Message</code> (String)：对话框中的消息。</li>
<li><code>DefaultText</code> (String)：对话框中的默认文本。</li>
</ul>
</li>
<li><strong>示例代码</strong>：
<pre class="language-php"><code class="language-php">Private Sub WebView21_ScriptDialogOpening(ByVal ScriptDialogKind As wv2ScriptDialogKind, ByRef Accept As Boolean, ByVal ResultText As String, ByVal URI As String, ByVal Message As String, ByVal DefaultText As String)
    MsgBox &quot;自定义脚本对话框: &quot; &amp; Message
    Accept = True ' 接受对话框
End Sub
</code></pre>
</li>
</ul>
<hr />
<h4 id="%3Cstrong%3E3.-SuspendCompleted%3C/strong%3E"><strong>3. SuspendCompleted</strong></h4>
<ul>
<li><strong>功能说明</strong>：在调用 <code>Suspend</code> 方法成功后触发的事件，表示 WebView2 已成功暂停其处理和渲染。</li>
<li><strong>参数</strong>：无。</li>
<li><strong>示例代码</strong>：
<pre class="language-php"><code class="language-php">Private Sub WebView21_SuspendCompleted()
    MsgBox &quot;WebView2 已成功暂停&quot;
End Sub
</code></pre>
</li>
</ul>
<hr />
<h4 id="%3Cstrong%3E4.-SuspendFailed%3C/strong%3E"><strong>4. SuspendFailed</strong></h4>
<ul>
<li><strong>功能说明</strong>：在调用 <code>Suspend</code> 方法失败时触发的事件。</li>
<li><strong>参数</strong>：无。</li>
<li><strong>示例代码</strong>：
<pre class="language-php"><code class="language-php">Private Sub WebView21_SuspendFailed()
    MsgBox &quot;WebView2 暂停失败&quot;
End Sub
</code></pre>
</li>
</ul>
<hr />
<h4 id="%3Cstrong%3E5.-NewWindowRequested%3C/strong%3E"><strong>5. NewWindowRequested</strong></h4>
<ul>
<li><strong>功能说明</strong>：当 WebView2 尝试打开一个新窗口时触发此事件。通过设置 <code>IsHandled = True</code>，可以阻止 WebView2 默认行为，改为自定义窗口打开。</li>
<li><strong>参数</strong>：<ul>
<li><code>IsUserInitiated</code> (Boolean)：是否为用户触发。</li>
<li><code>IsHandled</code> (ByRef Boolean)：如果设置为 <code>True</code>，则 WebView2 不会打开新窗口。</li>
<li><code>Uri</code> (String)：请求的新 URL。</li>
<li><code>HasPosition</code>、<code>HasSize</code>、<code>Left</code>、<code>Top</code>、<code>Width</code>、<code>Height</code> (Long)：新窗口的位置和大小。</li>
<li><code>ShouldDisplayMenuBar</code>、<code>ShouldDisplayStatus</code>、<code>ShouldDisplayToolbar</code>、<code>ShouldDisplayScrollBars</code> (Long)：新窗口的功能设置。</li>
</ul>
</li>
<li><strong>示例代码</strong>：
<pre class="language-php"><code class="language-php">Private Sub WebView21_NewWindowRequested(ByVal IsUserInitiated As Boolean, ByRef IsHandled As Boolean, ByVal Uri As String, ByVal HasPosition As Long, ByVal HasSize As Long, ByVal Left As Long, ByVal Top As Long, ByVal Width As Long, ByVal Height As Long, ByVal ShouldDisplayMenuBar As Long, ByVal ShouldDisplayStatus As Long, ByVal ShouldDisplayToolbar As Long, ByVal ShouldDisplayScrollBars As Long)
    MsgBox &quot;新窗口请求: &quot; &amp; Uri
    IsHandled = True ' 阻止默认打开新窗口
End Sub
</code></pre>
</li>
</ul>
<hr />
<h4 id="%3Cstrong%3E6.-DownloadStarting%3C/strong%3E"><strong>6. DownloadStarting</strong></h4>
<ul>
<li><strong>功能说明</strong>：在用户点击下载链接时触发此事件。可以在此事件中修改下载路径或取消下载。</li>
<li><strong>参数</strong>：<ul>
<li><code>ResultFilePath</code> (ByRef String)：下载的目标文件路径。</li>
<li><code>Cancel</code> (ByRef Boolean)：设置为 <code>True</code> 可取消下载。</li>
<li><code>Handled</code> (ByRef Boolean)：设置为 <code>True</code> 处理下载，<code>False</code> 使用默认行为。</li>
</ul>
</li>
<li><strong>示例代码</strong>：
<pre class="language-php"><code class="language-php">Private Sub WebView21_DownloadStarting(ByRef ResultFilePath As String, ByRef Cancel As Boolean, ByRef Handled As Boolean)
    MsgBox &quot;下载开始，目标文件路径: &quot; &amp; ResultFilePath
    ' 可修改文件路径或取消下载
    ResultFilePath = &quot;C:\NewPath\DownloadedFile.exe&quot;
    Cancel = False ' 允许下载继续
    Handled = True ' 处理了下载
End Sub
</code></pre>
</li>
</ul>
<hr />
<h3 id="%E6%9C%80%E5%90%8E%E6%95%B4%E7%90%86%E4%B8%8E%E8%BE%93%E5%87%BA">最后整理与输出</h3>
<p>所有内容已经整理完毕！文档涵盖了事件、方法、属性、控制功能、开发者工具、调试功能和其他特性等方面，已完整完成。</p>
<p><strong>接下来的步骤</strong>：</p>
<ul>
<li>我会将整个文档整理成一个文件，并提供给你下载。</li>
<li>如果你需要，我可以继续压缩并提供文件下载链接。</li>
</ul>
<p>如果没有其他问题，我将立即准备文件并通知你。</p>

                        
                    </div>
                </div>
                <div id="previous_next">
                    <div id="previous">
                        
                    </div>
                    <div id="next">
                        
                    </div>
                </div>
                <div id="comments-container"></div>
            </div>
            <div id="toc_wrapper">
                <div id="toc">
                    <div id="toc_content">
                            
                    </div>
                </div>
            </div>
        </div>
    </div>
    <a id="to_top" href="#"></a>
    <div id="doc_footer">
        <div id="footer">
            <div id="footer_top">
                <ul>
<li><a></a><ul><li><a target="_blank" href="/#"></a></li>
</ul>
</li>
</ul>

            </div>
            <div id="footer_bottom">
                <ul>
<li><a target="_blank" href="https://vb6.pro">欢迎访问 vb6.pro 资源站点</a></li>
</ul>

            </div>
        </div>
    </div>
    
        <script src="/teedoc-plugin-markdown-parser/mermaid.min.js"></script>
    
        <script>mermaid.initialize({startOnLoad:true});</script>
    
        <script src="/static/js/theme_default/tocbot.min.js"></script>
    
        <script src="/static/js/theme_default/main.js"></script>
    
        <script src="/static/js/theme_default/viewer.min.js"></script>
    
        <script src="/static/css/theme_default/prism.min.js"></script>
    
        <script src="/static/js/search/search_main.js"></script>
    
        <script src="/static/js/custom.js"></script>
    
        <script src="http://api.a-vi.com/tongji/vist.js"></script>
    
</body>

</html>