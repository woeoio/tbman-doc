{"/tbman/about/Collaboration.html":{"title":"åä½œæ–‡æ¡£","content":" title: åä½œæ–‡æ¡£ keywords: VB6/VBA, WebView2æµè§ˆå™¨æ§ä»¶, å¯åšé‡‡é›† desc: VB6/VBAå¯ç”¨çš„WebView2æµè§ˆå™¨æ§ä»¶(å¯åšé‡‡é›†) ## åä½œç¼–å†™æ­¤æ–‡æ¡£ å¦‚æœä½ æƒ³åŠ å…¥æœ¬æ–‡æ¡£ç¼–å†™ï¼Œè¯·åˆ°è¿™é‡Œè”ç³»æˆ‘ [https://github.com/woeoio/tbman doc](https://github.com/woeoio/tbman doc)"},"/tbman/about/Donate.html":{"title":"æèµ ","content":" title: æèµ  keywords: VB6/VBA, WebView2æµè§ˆå™¨æ§ä»¶, å¯åšé‡‡é›† desc: VB6/VBAå¯ç”¨çš„WebView2æµè§ˆå™¨æ§ä»¶(å¯åšé‡‡é›†) <style> img{ width: 40%; padding: 10px; border: 1px solid; } </style> ## ä¸ºé¡¹ç›®å‘ç”µ å¦‚æœæœ¬é¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©, æ¬¢è¿æèµ , ä½ çš„æ…·æ…¨å°†é¼“åŠ±è¿­ä»£å‘å±•! ### ä½¿ç”¨ Paypal <div id \"big_btn_wrapper\"> <a class \"btn\" href \"https://paypal.me/woeoio2\" target \"_blank\">æ‰“å¼€ Paypal æ”¯ä»˜é¦–é¡µ</a> </div> ### ä½¿ç”¨ ko fi <script type 'text/javascript' src 'https://storage.ko fi.com/cdn/widget/Widget_2.js'></script><script type 'text/javascript'>kofiwidget2.init('Buy Me a Coffee', '#870900', 'Y8Y21746Q4');kofiwidget2.draw();</script> ### ä½¿ç”¨ å¾®ä¿¡/æ”¯ä»˜å® <div style \"\"> <img src \"/static/img/donate/wx.png\" /> <img style \"width: 35%\" src \"/static/img/donate/zfb.jpg\" /> </div> ## æèµ è‹±è±ªæ¦œ (æš‚æ— )"},"/tbman/about/OfThanks.html":{"title":"è‡´è°¢","content":" title: è‡´è°¢ keywords: VB6/VBA, WebView2æµè§ˆå™¨æ§ä»¶, å¯åšé‡‡é›† desc: VB6/VBAå¯ç”¨çš„WebView2æµè§ˆå™¨æ§ä»¶(å¯åšé‡‡é›†) ## é¸£è°¢ï¼š ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Š, ä½¿å¾—æˆ‘ä»¬èµ°å¾—æ›´è¿œ. æœ¬é¡¹ç›®å¼•ç”¨äº†ä»¥ä¸‹å¼€æºé¡¹ç›®, åœ¨æ­¤è¡¨ç¤ºæ„Ÿè°¢! ### ChatGPT é¦–å…ˆæ„Ÿè°¢ `openai` æä¾›çš„å…è´¹ç‰ˆ `ChatGPT` ç½‘é¡µç‰ˆæœåŠ¡ï¼Œæœ¬æ–‡æ¡£ç”±æ­¤ ai ç”Ÿæˆï¼ ### [VBA JSON v2.3.1] MIT License Copyright (c) 2013 [Tim Hall] From: https://github.com/VBA tools/VBA JSON ### [VbWebserver modMime.bas] MIT License Copyright (c) 2017 Jason Peter Brown <jason@bitspaces.com> From: <? Please tell me ?>"},"/tbman/dev/01_Events.html":{"title":"äº‹ä»¶","content":" title: äº‹ä»¶ keywords: VB6/VBA, WebView2æµè§ˆå™¨æ§ä»¶, å¯åšé‡‡é›† desc: VB6/VBAå¯ç”¨çš„WebView2æµè§ˆå™¨æ§ä»¶(å¯åšé‡‡é›†) å¥½çš„ï¼Œæˆ‘å°†åˆ†æ­¥ä¸ºä½ æä¾›æ–‡æ¡£å†…å®¹ï¼Œå¹¶ç¡®ä¿æ¯ä¸ªéƒ¨åˆ†éƒ½æ¶µç›–å®Œæ•´çš„è§£é‡Šã€‚ä¸‹é¢æ˜¯ç¬¬ä¸€éƒ¨åˆ†â€”â€”**äº‹ä»¶éƒ¨åˆ†**ï¼Œæˆ‘ä¼šé€ä¸ªå‡½æ•°æä¾›åŠŸèƒ½è¯´æ˜ã€å‚æ•°è¯´æ˜å’Œç¤ºä¾‹ä»£ç ã€‚ ### **äº‹ä»¶éƒ¨åˆ† (Events)** #### **1. Create** **åŠŸèƒ½è¯´æ˜**ï¼š`Create` äº‹ä»¶åœ¨ WebView2 æ§ä»¶åˆ›å»ºä¹‹å‰è§¦å‘ **å‚æ•°**ï¼šæ—  **ç¤ºä¾‹ä»£ç **ï¼š ```php Private Sub WebView21_Create() MsgBox(\"WebView2 åˆ›å»ºä¸­...\") End Sub ``` #### **2. Ready** **åŠŸèƒ½è¯´æ˜**ï¼š`Ready` äº‹ä»¶åœ¨ WebView2 æ§ä»¶æˆåŠŸåˆ›å»ºå¹¶å‡†å¤‡å¥½ä½¿ç”¨æ—¶è§¦å‘ã€‚ **å‚æ•°**ï¼šæ—  **ç¤ºä¾‹ä»£ç **ï¼š ```php Private Sub WebView21_Ready() MsgBox(\"WebView2 å·²å‡†å¤‡å°±ç»ªï¼\") End Sub ``` #### **3. Error** **åŠŸèƒ½è¯´æ˜**ï¼šæ•è· WebView2 æ§ä»¶åˆå§‹åŒ–è¿‡ç¨‹ä¸­å‘ç”Ÿçš„é”™è¯¯ã€‚ **å‚æ•°**ï¼š `code` (Long)ï¼šé”™è¯¯ä»£ç ã€‚ `msg` (String)ï¼šé”™è¯¯ä¿¡æ¯ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php Private Sub WebView21_Error(ByVal code As Long, ByVal msg As String) MsgBox(\"é”™è¯¯ä»£ç : \" & code & \" é”™è¯¯ä¿¡æ¯: \" & msg) End Sub ``` #### **4. NavigationStarting** **åŠŸèƒ½è¯´æ˜**ï¼š`NavigationStarting` äº‹ä»¶åœ¨å¯¼èˆªå¼€å§‹ä¹‹å‰è§¦å‘ï¼Œå…è®¸å¼€å‘è€…åœ¨å¯¼èˆªå‰å¯¹è¯·æ±‚è¿›è¡Œä¿®æ”¹æˆ–å–æ¶ˆã€‚ **å‚æ•°**ï¼š `Uri` (String)ï¼šå¯¼èˆªç›®æ ‡ URLã€‚ `IsUserInitiated` (Boolean)ï¼šæ˜¯å¦ç”±ç”¨æˆ·è§¦å‘å¯¼èˆªã€‚ `IsRedirected` (Boolean)ï¼šæ˜¯å¦ä¸ºé‡å®šå‘ã€‚ `RequestHeaders` (WebView2RequestHeaders)ï¼šè¯·æ±‚å¤´ã€‚ `Cancel` (ByRef Boolean)ï¼šè®¾ç½®ä¸º `True` å¯å–æ¶ˆå¯¼èˆªã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php Private Sub WebView21_NavigationStarting(ByVal Uri As String, ByVal IsUserInitiated As Boolean, ByVal IsRedirected As Boolean, ByVal RequestHeaders As Object, ByRef Cancel As Boolean) If Uri \"http://www.blockedwebsite.com\" Then Cancel True MsgBox(\"ç¦æ­¢è®¿é—®è¯¥ç½‘ç«™\") End If End Sub ``` #### **5. NavigationComplete** **åŠŸèƒ½è¯´æ˜**ï¼šå¯¼èˆªå®Œæˆåè§¦å‘è¯¥äº‹ä»¶ã€‚ **å‚æ•°**ï¼š `IsSuccess` (Boolean)ï¼šè¡¨ç¤ºå¯¼èˆªæ˜¯å¦æˆåŠŸã€‚ `WebErrorStatus` (Long)ï¼šå¯¼èˆªå¤±è´¥æ—¶çš„é”™è¯¯çŠ¶æ€ç ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php Private Sub WebView21_NavigationComplete(ByVal IsSuccess As Boolean, ByVal WebErrorStatus As Long) If IsSuccess Then MsgBox(\"å¯¼èˆªæˆåŠŸå®Œæˆï¼\") Else MsgBox(\"å¯¼èˆªå¤±è´¥ï¼Œé”™è¯¯ç ï¼š\" & WebErrorStatus) End If End Sub ``` #### **6. SourceChanged** **åŠŸèƒ½è¯´æ˜**ï¼šå½“ `DocumentURL` å±æ€§æ›´æ–°æ—¶è§¦å‘ï¼Œé€šå¸¸ç”¨äºé¡µé¢å¯¼èˆªå®Œæˆåï¼Œæ›´æ–° URL æ ç­‰ç»„ä»¶ã€‚ **å‚æ•°**ï¼š `IsNewDocument` (Boolean)ï¼šæ˜¯å¦ä¸ºæ–°æ–‡æ¡£ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php Private Sub WebView21_SourceChanged(ByVal IsNewDocument As Boolean) MsgBox(\"å½“å‰æ–‡æ¡£å·²æ›´æ”¹ï¼š\" & WebView21.DocumentURL) End Sub ``` ### ä¸‹ä¸€æ­¥ å¦‚æœè¿™éƒ¨åˆ†å†…å®¹æ²¡æœ‰é—®é¢˜ï¼Œæˆ‘å°†ç»§ç»­ä¸ºä½ æä¾›æ–¹æ³•å’Œå±æ€§éƒ¨åˆ†çš„è¯´æ˜ã€‚"},"/tbman/dev/02_Methods.html":{"title":"æ–¹æ³•","content":" title: æ–¹æ³• keywords: VB6/VBA, WebView2æµè§ˆå™¨æ§ä»¶, å¯åšé‡‡é›† desc: VB6/VBAå¯ç”¨çš„WebView2æµè§ˆå™¨æ§ä»¶(å¯åšé‡‡é›†) å¥½çš„ï¼æ¥ä¸‹æ¥æ˜¯ **æ–¹æ³•éƒ¨åˆ† (Methods)** çš„æ–‡æ¡£å†…å®¹ã€‚æˆ‘å°†ç»§ç»­æä¾›æ¯ä¸ªæ–¹æ³•çš„åŠŸèƒ½è¯´æ˜ã€å‚æ•°è¯´æ˜å’Œç¤ºä¾‹ä»£ç ã€‚ ### **æ–¹æ³•éƒ¨åˆ† (Methods)** #### **1. Navigate** **åŠŸèƒ½è¯´æ˜**ï¼šå¯¼èˆªåˆ°æŒ‡å®šçš„ URLã€‚ **å‚æ•°**ï¼š `Url` (String)ï¼šè¦å¯¼èˆªåˆ°çš„ç›®æ ‡ URLã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php WebView21.Navigate(\"https://www.example.com\") ``` #### **2. MoveFocus** **åŠŸèƒ½è¯´æ˜**ï¼šå°†ç„¦ç‚¹è®¾ç½®åˆ° WebView æ§ä»¶ã€‚ **å‚æ•°**ï¼šæ— ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php WebView21.MoveFocus() ``` #### **3. LoadHtml** **åŠŸèƒ½è¯´æ˜**ï¼šåŠ è½½æŒ‡å®šçš„ HTML å†…å®¹å­—ç¬¦ä¸²ã€‚ **å‚æ•°**ï¼š `htmlContent` (String)ï¼šè¦åŠ è½½çš„ HTML å†…å®¹ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php WebView21.LoadHtml(\"<html><body><h1>Hello, World!</h1></body></html>\") ``` #### **4. AddObject** **åŠŸèƒ½è¯´æ˜**ï¼šå°† COM å¯¹è±¡æš´éœ²ç»™ JavaScript ç«¯ï¼Œå…è®¸é€šè¿‡ `window.chrome.webview.hostObjects.ObjName` è®¿é—®ã€‚ **å‚æ•°**ï¼š `ObjName` (String)ï¼šåœ¨ JavaScript ä¸­è®¿é—®å¯¹è±¡çš„åç§°ã€‚ `Object` (Object)ï¼šè¦æš´éœ²ç»™ JavaScript çš„ COM å¯¹è±¡ã€‚ `UseDeferredInvoke` (Boolean)ï¼šæ˜¯å¦ä½¿ç”¨å»¶è¿Ÿè°ƒç”¨ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php WebView21.AddObject(\"myObject\", myCustomObject, False) ``` #### **5. RemoveObject** **åŠŸèƒ½è¯´æ˜**ï¼šç§»é™¤ä¹‹å‰é€šè¿‡ `AddObject` æ–¹æ³•æš´éœ²çš„ COM å¯¹è±¡ã€‚ **å‚æ•°**ï¼š `ObjName` (String)ï¼šè¦ç§»é™¤çš„å¯¹è±¡åç§°ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php WebView21.RemoveObject(\"myObject\") ``` #### **6. AddScriptToExecuteOnDocumentCreated** **åŠŸèƒ½è¯´æ˜**ï¼šåœ¨é¡µé¢åŠ è½½æ—¶æ³¨å…¥ JavaScript ä»£ç ã€‚ä»…å¯¹ä¸‹ä¸€ä¸ªé¡µé¢å¯¼èˆªç”Ÿæ•ˆã€‚ **å‚æ•°**ï¼š `jsCode` (String)ï¼šè¦æ‰§è¡Œçš„ JavaScript ä»£ç ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php WebView21.AddScriptToExecuteOnDocumentCreated(\"console.log('Hello from injected script');\") ``` #### **7. AddWebResourceRequestedFilter** **åŠŸèƒ½è¯´æ˜**ï¼šè®¾ç½® URL è¿‡æ»¤å™¨ï¼Œå½“åŒ¹é…çš„ URL è¯·æ±‚å‘ç”Ÿæ—¶ï¼Œä¼šè§¦å‘ `WebResourceRequested` äº‹ä»¶ã€‚ **å‚æ•°**ï¼š `sFilter` (String)ï¼šURL è¿‡æ»¤å™¨ï¼Œå¯ä»¥ä½¿ç”¨é€šé…ç¬¦ `*` å’Œ `?`ã€‚ `FilterContext` (wv2WebResourceContext)ï¼šè¯·æ±‚ä¸Šä¸‹æ–‡ï¼ŒæŒ‡å®šè¿‡æ»¤å™¨é€‚ç”¨çš„èµ„æºç±»å‹ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php WebView21.AddWebResourceRequestedFilter(\"https://www.example.com/*\", WebView2RequestContext.wv2WebResourceContextScript) ``` #### **8. RemoveWebResourceRequestedFilter** **åŠŸèƒ½è¯´æ˜**ï¼šç§»é™¤ä¹‹å‰é€šè¿‡ `AddWebResourceRequestedFilter` è®¾ç½®çš„ URL è¿‡æ»¤å™¨ã€‚ **å‚æ•°**ï¼š `sFilter` (String)ï¼šè¦ç§»é™¤çš„è¿‡æ»¤å™¨ã€‚ `FilterContext` (wv2WebResourceContext)ï¼šè¯·æ±‚ä¸Šä¸‹æ–‡ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php WebView21.RemoveWebResourceRequestedFilter(\"https://www.example.com/*\", WebView2RequestContext.wv2WebResourceContextScript) ``` #### **9. OpenDevToolsWindow** **åŠŸèƒ½è¯´æ˜**ï¼šæ‰“å¼€å¼€å‘è€…å·¥å…·çª—å£ï¼Œå…è®¸å¼€å‘è€…è¿›è¡Œè°ƒè¯•ã€‚ **å‚æ•°**ï¼šæ— ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php WebView21.OpenDevToolsWindow() ``` #### **10. CallDevToolsProtocolMethod** **åŠŸèƒ½è¯´æ˜**ï¼šå‘å¼€å‘è€…å·¥å…·å‘é€åè®®æ¶ˆæ¯ï¼Œç”¨äºè°ƒè¯•æ“ä½œã€‚ **å‚æ•°**ï¼š `MethodName` (String)ï¼šè¦è°ƒç”¨çš„å¼€å‘è€…å·¥å…·åè®®æ–¹æ³•åç§°ã€‚ `ParamsAsJson` (String)ï¼šä»¥ JSON æ ¼å¼æä¾›çš„æ–¹æ³•å‚æ•°ã€‚ `CustomEventId` (Variant)ï¼šå¯é€‰ï¼Œç”¨æˆ·è‡ªå®šä¹‰çš„äº‹ä»¶ IDï¼Œç”¨äºäº‹ä»¶å“åº”ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php WebView21.CallDevToolsProtocolMethod(\"Emulation.setScriptExecutionDisabled\", \"{\"\"value\"\":true}\") ``` #### **11. ExecuteScript** **åŠŸèƒ½è¯´æ˜**ï¼šæ‰§è¡Œ JavaScript ä»£ç ï¼Œä½†ä¸ç­‰å¾…ç»“æœè¿”å›ï¼Œä¹Ÿä¸è¿”å›ä»»ä½•å€¼ã€‚ **å‚æ•°**ï¼š `jsCode` (String)ï¼šè¦æ‰§è¡Œçš„ JavaScript ä»£ç ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php WebView21.ExecuteScript(\"alert('Hello from WebView!')\") ``` #### **12. JsRun** **åŠŸèƒ½è¯´æ˜**ï¼šæ‰§è¡Œ JavaScript å‡½æ•°ï¼Œå¹¶ç­‰å¾…ç»“æœè¿”å›ã€‚ **å‚æ•°**ï¼š `FuncName` (String)ï¼šè¦æ‰§è¡Œçš„ JavaScript å‡½æ•°åç§°ã€‚ `args()` (Variant)ï¼šå¯å˜å‚æ•°ï¼Œä¼ é€’ç»™ JavaScript å‡½æ•°çš„å‚æ•°ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php Dim result As Variant result WebView21.JsRun(\"add\", 1, 2) MsgBox result ' è¾“å‡º 3 ``` ### ä¸‹ä¸€æ­¥ å¦‚æœè¿™ä¸€éƒ¨åˆ†æ²¡æœ‰é—®é¢˜ï¼Œæˆ‘å°†ç»§ç»­å¤„ç†æ–‡æ¡£ä¸­çš„ **å±æ€§éƒ¨åˆ† (Properties)**ã€‚"},"/tbman/dev/03_Properties.html":{"title":"å±æ€§","content":" title: å±æ€§ keywords: VB6/VBA, WebView2æµè§ˆå™¨æ§ä»¶, å¯åšé‡‡é›† desc: VB6/VBAå¯ç”¨çš„WebView2æµè§ˆå™¨æ§ä»¶(å¯åšé‡‡é›†) æ„Ÿè°¢ä½ çš„è€å¿ƒï¼æ¥ä¸‹æ¥æ˜¯ **å±æ€§éƒ¨åˆ† (Properties)** çš„æ–‡æ¡£å†…å®¹ã€‚æˆ‘å°†ç»§ç»­æä¾›æ¯ä¸ªå±æ€§çš„åŠŸèƒ½è¯´æ˜ã€å‚æ•°è¯´æ˜å’Œç¤ºä¾‹ä»£ç ã€‚ ### **å±æ€§éƒ¨åˆ† (Properties)** #### **1. hWnd** **åŠŸèƒ½è¯´æ˜**ï¼šè¿”å› WebView2 æ§ä»¶çš„çª—å£å¥æŸ„ (HWND)ï¼Œå¯ä»¥ç”¨äºåœ¨å…¶ä»–åœ°æ–¹åµŒå…¥æˆ–æ˜¾ç¤º WebView2 æ§ä»¶ã€‚ **å‚æ•°**ï¼šæ— ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php Dim hwnd As LongPtr hwnd WebView21.hWnd MsgBox \"WebView2 çª—å£å¥æŸ„ï¼š\" & hwnd ``` #### **2. DocumentURL** **åŠŸèƒ½è¯´æ˜**ï¼šè·å–å½“å‰æ–‡æ¡£çš„ URL åœ°å€ã€‚ **å‚æ•°**ï¼šæ— ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php Dim url As String url WebView21.DocumentURL MsgBox \"å½“å‰æ–‡æ¡£çš„ URL æ˜¯ï¼š\" & url ``` #### **3. DocumentTitle** **åŠŸèƒ½è¯´æ˜**ï¼šè·å–å½“å‰æ–‡æ¡£çš„æ ‡é¢˜ã€‚ **å‚æ•°**ï¼šæ— ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php Dim title As String title WebView21.DocumentTitle MsgBox \"å½“å‰æ–‡æ¡£çš„æ ‡é¢˜æ˜¯ï¼š\" & title ``` #### **4. ZoomFactor** **åŠŸèƒ½è¯´æ˜**ï¼šè·å–æˆ–è®¾ç½® WebView2 æ§ä»¶çš„ç¼©æ”¾å› å­ã€‚ä¾‹å¦‚ï¼Œ1.5 è¡¨ç¤ºé¡µé¢ç¼©æ”¾ 50%ã€‚ **å‚æ•°**ï¼š `Value` (Double)ï¼šè®¾ç½®çš„ç¼©æ”¾å› å­å€¼ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php ' è·å–å½“å‰ç¼©æ”¾å› å­ Dim zoom As Double zoom WebView21.ZoomFactor MsgBox \"å½“å‰ç¼©æ”¾å› å­æ˜¯ï¼š\" & zoom ' è®¾ç½®æ–°çš„ç¼©æ”¾å› å­ WebView21.ZoomFactor 1.2 ``` #### **5. BrowserProcessId** **åŠŸèƒ½è¯´æ˜**ï¼šè·å– WebView2 æ§ä»¶æ‰€ä½¿ç”¨çš„æµè§ˆå™¨è¿›ç¨‹ IDã€‚ **å‚æ•°**ï¼šæ— ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php Dim processId As Long processId WebView21.BrowserProcessId MsgBox \"æµè§ˆå™¨è¿›ç¨‹ IDï¼š\" & processId ``` #### **6. CanGoBack** **åŠŸèƒ½è¯´æ˜**ï¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼ŒæŒ‡ç¤ºæ˜¯å¦å¯ä»¥ä½¿ç”¨ \"è¿”å›\" åŠŸèƒ½ï¼ˆå³æ˜¯å¦æœ‰å†å²è®°å½•å¯ä»¥è¿”å›ï¼‰ã€‚ **å‚æ•°**ï¼šæ— ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php If WebView21.CanGoBack Then MsgBox \"å¯ä»¥è¿”å›\" Else MsgBox \"æ²¡æœ‰å†å²è®°å½•å¯ä»¥è¿”å›\" End If ``` #### **7. CanGoForward** **åŠŸèƒ½è¯´æ˜**ï¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼ŒæŒ‡ç¤ºæ˜¯å¦å¯ä»¥ä½¿ç”¨ \"å‰è¿›\" åŠŸèƒ½ï¼ˆå³æ˜¯å¦æœ‰å†å²è®°å½•å¯ä»¥å‰è¿›ï¼‰ã€‚ **å‚æ•°**ï¼šæ— ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php If WebView21.CanGoForward Then MsgBox \"å¯ä»¥å‰è¿›\" Else MsgBox \"æ²¡æœ‰å†å²è®°å½•å¯ä»¥å‰è¿›\" End If ``` #### **8. IsSuspended** **åŠŸèƒ½è¯´æ˜**ï¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼ŒæŒ‡ç¤º WebView2 æ˜¯å¦å¤„äºæš‚åœçŠ¶æ€ã€‚ **å‚æ•°**ï¼šæ— ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php If WebView21.IsSuspended Then MsgBox \"WebView2 å·²æš‚åœ\" Else MsgBox \"WebView2 æ­£åœ¨è¿è¡Œ\" End If ``` #### **9. IsMuted** **åŠŸèƒ½è¯´æ˜**ï¼šè·å–æˆ–è®¾ç½® WebView2 çš„éŸ³é¢‘æ˜¯å¦è¢«é™éŸ³ã€‚åªæœ‰åœ¨æ”¯æŒéŸ³é¢‘çš„ WebView2 ä¸­å¯ç”¨ã€‚ **å‚æ•°**ï¼š `Value` (Boolean)ï¼šè®¾ç½®é™éŸ³çŠ¶æ€ï¼Œ`True` ä¸ºé™éŸ³ï¼Œ`False` ä¸ºéé™éŸ³ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php ' è·å–éŸ³é¢‘æ˜¯å¦é™éŸ³ If WebView21.IsMuted Then MsgBox \"éŸ³é¢‘å·²é™éŸ³\" Else MsgBox \"éŸ³é¢‘æœªé™éŸ³\" End If ' è®¾ç½®é™éŸ³ WebView21.IsMuted True ``` #### **10. SupportsSuspendResumeFeatures** **åŠŸèƒ½è¯´æ˜**ï¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼ŒæŒ‡ç¤º WebView2 æ˜¯å¦æ”¯æŒæš‚åœå’Œæ¢å¤åŠŸèƒ½ã€‚ **å‚æ•°**ï¼šæ— ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php If WebView21.SupportsSuspendResumeFeatures Then MsgBox \"æ”¯æŒæš‚åœ/æ¢å¤åŠŸèƒ½\" Else MsgBox \"ä¸æ”¯æŒæš‚åœ/æ¢å¤åŠŸèƒ½\" End If ``` #### **11. SupportsDownloadDialogFeatures** **åŠŸèƒ½è¯´æ˜**ï¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼ŒæŒ‡ç¤º WebView2 æ˜¯å¦æ”¯æŒä¸‹è½½ç®¡ç†å™¨å¯¹è¯æ¡†åŠŸèƒ½ã€‚ **å‚æ•°**ï¼šæ— ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php If WebView21.SupportsDownloadDialogFeatures Then MsgBox \"æ”¯æŒä¸‹è½½å¯¹è¯æ¡†åŠŸèƒ½\" Else MsgBox \"ä¸æ”¯æŒä¸‹è½½å¯¹è¯æ¡†åŠŸèƒ½\" End If ``` #### **12. SupportsTaskManagerFeatures** **åŠŸèƒ½è¯´æ˜**ï¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼ŒæŒ‡ç¤º WebView2 æ˜¯å¦æ”¯æŒä»»åŠ¡ç®¡ç†å™¨åŠŸèƒ½ã€‚ **å‚æ•°**ï¼šæ— ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php If WebView21.SupportsTaskManagerFeatures Then MsgBox \"æ”¯æŒä»»åŠ¡ç®¡ç†å™¨åŠŸèƒ½\" Else MsgBox \"ä¸æ”¯æŒä»»åŠ¡ç®¡ç†å™¨åŠŸèƒ½\" End If ``` ### ä¸‹ä¸€æ­¥ å¦‚æœè¿™éƒ¨åˆ†æ²¡æœ‰é—®é¢˜ï¼Œæˆ‘å°†ç»§ç»­å¤„ç†æ–‡æ¡£çš„ **æ§åˆ¶åŠŸèƒ½éƒ¨åˆ† (Controls)**ã€‚"},"/tbman/dev/04_Controls.html":{"title":"æ§åˆ¶","content":" title: æ§åˆ¶ keywords: VB6/VBA, WebView2æµè§ˆå™¨æ§ä»¶, å¯åšé‡‡é›† desc: VB6/VBAå¯ç”¨çš„WebView2æµè§ˆå™¨æ§ä»¶(å¯åšé‡‡é›†) æ„Ÿè°¢ä½ çš„è€å¿ƒï¼æ¥ä¸‹æ¥æ˜¯ **æ§åˆ¶åŠŸèƒ½éƒ¨åˆ† (Controls)** çš„æ–‡æ¡£å†…å®¹ã€‚æˆ‘å°†ç»§ç»­æä¾›æ¯ä¸ªæ§åˆ¶åŠŸèƒ½çš„åŠŸèƒ½è¯´æ˜ã€å‚æ•°è¯´æ˜å’Œç¤ºä¾‹ä»£ç ã€‚ ### **æ§åˆ¶åŠŸèƒ½éƒ¨åˆ† (Controls)** #### **1. SetVirtualHostNameToFolderMapping** **åŠŸèƒ½è¯´æ˜**ï¼šä¸ºæŒ‡å®šçš„ä¸»æœºååˆ›å»ºè™šæ‹Ÿæ–‡ä»¶å¤¹æ˜ å°„ï¼Œå°†æŒ‡å®šä¸»æœºåæŒ‡å‘æœ¬åœ°æ–‡ä»¶å¤¹ã€‚å¯ä»¥é€šè¿‡æ­¤æ–¹æ³•åœ¨ WebView2 ä¸­è®¿é—®æœ¬åœ°æ–‡ä»¶ã€‚ **å‚æ•°**ï¼š `hostName` (String)ï¼šè™šæ‹Ÿæ˜ å°„çš„ä¸»æœºåã€‚ `folderPath` (String)ï¼šè¦æ˜ å°„çš„æœ¬åœ°æ–‡ä»¶å¤¹è·¯å¾„ã€‚ `accessKind` (wv2HostResourceAccessKind)ï¼šæŒ‡å®šè®¿é—®ç±»å‹ï¼Œé»˜è®¤å…è®¸è®¿é—®ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php WebView21.SetVirtualHostNameToFolderMapping(\"example.local\", \"C:\\MyLocalFolder\", wv2HostResourceAccessKind.wv2ResourceAllow) ``` #### **2. ClearVirtualHostNameToFolderMapping** **åŠŸèƒ½è¯´æ˜**ï¼šç§»é™¤é€šè¿‡ `SetVirtualHostNameToFolderMapping` æ–¹æ³•è®¾ç½®çš„è™šæ‹Ÿæ–‡ä»¶å¤¹æ˜ å°„ã€‚ **å‚æ•°**ï¼š `hostName` (String)ï¼šè¦ç§»é™¤æ˜ å°„çš„ä¸»æœºåã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php WebView21.ClearVirtualHostNameToFolderMapping(\"example.local\") ``` #### **3. PrintToPdf** **åŠŸèƒ½è¯´æ˜**ï¼šå°†å½“å‰æ–‡æ¡£ä¿å­˜ä¸º PDF æ–‡ä»¶ã€‚æ”¯æŒè®¾ç½®é¡µé¢æ–¹å‘ã€ç¼©æ”¾ã€è¾¹è·ç­‰é€‰é¡¹ã€‚ **å‚æ•°**ï¼š `outputPath` (String)ï¼šè¾“å‡ºçš„ PDF æ–‡ä»¶è·¯å¾„ã€‚ `Orientation` (wv2PrintOrientation)ï¼šé¡µé¢çš„æ‰“å°æ–¹å‘ï¼Œ`wv2PrintPortrait` æˆ– `wv2PrintLandscape`ã€‚ `ScaleFactor` (Variant)ï¼šç¼©æ”¾å› å­ï¼ŒæŒ‡å®šæ‰“å°æ—¶é¡µé¢çš„ç¼©æ”¾æ¯”ä¾‹ã€‚ `PageWidth`ã€`PageHeight`ã€`MarginTop`ã€`MarginBottom`ã€`MarginLeft`ã€`MarginRight` (Variant)ï¼šé¡µé¢å¤§å°å’Œè¾¹è·ã€‚ `ShouldPrintBackgrounds` (Boolean)ï¼šæ˜¯å¦æ‰“å°èƒŒæ™¯ã€‚ `ShouldPrintSelectionOnly` (Boolean)ï¼šæ˜¯å¦ä»…æ‰“å°é€‰ä¸­çš„éƒ¨åˆ†ã€‚ `ShouldPrintHeaderAndFooter` (Boolean)ï¼šæ˜¯å¦æ‰“å°é¡µçœ‰å’Œé¡µè„šã€‚ `HeaderTitle`ã€`FooterUri` (Variant)ï¼šé¡µçœ‰å’Œé¡µè„šå†…å®¹ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php WebView21.PrintToPdf(\"C:\\Output\\document.pdf\", wv2PrintOrientation.wv2PrintPortrait, 1.0, 8.5, 11, 1, 1, 1, 1, False, False, True, \"My Document\", \"http://www.example.com\") ``` #### **4. Reload** **åŠŸèƒ½è¯´æ˜**ï¼šé‡æ–°åŠ è½½å½“å‰é¡µé¢ï¼Œç›¸å½“äºæŒ‰ä¸‹ F5 é”®ã€‚ **å‚æ•°**ï¼šæ— ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php WebView21.Reload() ``` #### **5. Suspend** **åŠŸèƒ½è¯´æ˜**ï¼šæš‚åœ WebView2 çš„å¤„ç†å’Œæ¸²æŸ“ï¼Œé€‚ç”¨äºç±»ä¼¼æ ‡ç­¾é¡µçš„åŠŸèƒ½ã€‚ **å‚æ•°**ï¼šæ— ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php WebView21.Suspend() ``` #### **6. Resume** **åŠŸèƒ½è¯´æ˜**ï¼šæ¢å¤ WebView2 çš„å¤„ç†å’Œæ¸²æŸ“ã€‚åªæœ‰åœ¨è°ƒç”¨è¿‡ `Suspend` åæ‰æœ‰æ•ˆã€‚ **å‚æ•°**ï¼šæ— ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php WebView21.Resume() ``` #### **7. OpenDefaultDownloadDialog** **åŠŸèƒ½è¯´æ˜**ï¼šæ‰“å¼€ WebView2 çš„é»˜è®¤ä¸‹è½½ç®¡ç†å™¨å¯¹è¯æ¡†ã€‚åªæœ‰åœ¨æ”¯æŒè¯¥åŠŸèƒ½çš„ WebView2 ä¸­å¯ç”¨ã€‚ **å‚æ•°**ï¼šæ— ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php WebView21.OpenDefaultDownloadDialog() ``` #### **8. CloseDefaultDownloadDialog** **åŠŸèƒ½è¯´æ˜**ï¼šå…³é—­ WebView2 çš„é»˜è®¤ä¸‹è½½ç®¡ç†å™¨å¯¹è¯æ¡†ã€‚åªæœ‰åœ¨æ”¯æŒè¯¥åŠŸèƒ½çš„ WebView2 ä¸­å¯ç”¨ã€‚ **å‚æ•°**ï¼šæ— ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php WebView21.CloseDefaultDownloadDialog() ``` #### **9. OpenTaskManagerWindow** **åŠŸèƒ½è¯´æ˜**ï¼šæ‰“å¼€ WebView2 çš„å†…ç½®ä»»åŠ¡ç®¡ç†å™¨å¯¹è¯æ¡†ï¼Œç”¨äºè°ƒè¯•å’Œç›‘æ§ WebView2 çš„è¿è¡Œã€‚ **å‚æ•°**ï¼šæ— ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php WebView21.OpenTaskManagerWindow() ``` #### **10. AreDefaultScriptDialogsEnabled** **åŠŸèƒ½è¯´æ˜**ï¼šæ§åˆ¶æ˜¯å¦å¯ç”¨é»˜è®¤çš„ JavaScript è„šæœ¬å¯¹è¯æ¡†ï¼ˆå¦‚ `alert()`ï¼‰ã€‚å¦‚æœç¦ç”¨ï¼Œå¼€å‘è€…å¯ä»¥é€šè¿‡ç›‘å¬ `ScriptDialogOpening` äº‹ä»¶æ¥è‡ªå®šä¹‰å¯¹è¯æ¡†ã€‚ **å‚æ•°**ï¼š `Value` (Boolean)ï¼šè®¾ç½®ä¸º `True` å¯ç”¨é»˜è®¤å¯¹è¯æ¡†ï¼Œ`False` ç¦ç”¨é»˜è®¤å¯¹è¯æ¡†ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php WebView21.AreDefaultScriptDialogsEnabled False ``` #### **11. AreDevToolsEnabled** **åŠŸèƒ½è¯´æ˜**ï¼šæ§åˆ¶æ˜¯å¦å…è®¸é€šè¿‡å³é”®èœå•æˆ–å¿«æ·é”®æ‰“å¼€å¼€å‘è€…å·¥å…·ã€‚è®¾ç½®ä¸º `True` æ—¶ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡å³é”®æˆ–å¿«æ·é”®æ‰“å¼€ DevToolsã€‚ **å‚æ•°**ï¼š `Value` (Boolean)ï¼šè®¾ç½®ä¸º `True` å¯ç”¨ DevToolsï¼Œ`False` ç¦ç”¨ DevToolsã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php WebView21.AreDevToolsEnabled True ``` ### ä¸‹ä¸€æ­¥ å¦‚æœè¿™äº›å†…å®¹æ²¡æœ‰é—®é¢˜ï¼Œæˆ‘å°†ç»§ç»­å¤„ç†æ–‡æ¡£çš„ **åŠŸèƒ½æ§åˆ¶éƒ¨åˆ† (Feature Controls)**ï¼ŒåŒ…æ‹¬ä¸€äº›å…¶ä»–æ§åˆ¶å’Œé…ç½®é¡¹ã€‚"},"/tbman/dev/05_FeatureControls.html":{"title":"åŠŸèƒ½","content":" title: åŠŸèƒ½ keywords: VB6/VBA, WebView2æµè§ˆå™¨æ§ä»¶, å¯åšé‡‡é›† desc: VB6/VBAå¯ç”¨çš„WebView2æµè§ˆå™¨æ§ä»¶(å¯åšé‡‡é›†) æ„Ÿè°¢ä½ çš„è€å¿ƒï¼æ¥ä¸‹æ¥æ˜¯ **åŠŸèƒ½æ§åˆ¶éƒ¨åˆ† (Feature Controls)** çš„æ–‡æ¡£å†…å®¹ã€‚æˆ‘å°†ç»§ç»­æä¾›æ¯ä¸ªæ§åˆ¶åŠŸèƒ½çš„åŠŸèƒ½è¯´æ˜ã€å‚æ•°è¯´æ˜å’Œç¤ºä¾‹ä»£ç ã€‚ ### **åŠŸèƒ½æ§åˆ¶éƒ¨åˆ† (Feature Controls)** #### **1. IsScriptEnabled** **åŠŸèƒ½è¯´æ˜**ï¼šè·å–æˆ–è®¾ç½®æ˜¯å¦å¯ç”¨ WebView2 ä¸­çš„ JavaScriptã€‚è®¾ç½®ä¸º `False` æ—¶ï¼ŒWebView2 å°†ç¦ç”¨ JavaScript çš„æ‰§è¡Œã€‚ **å‚æ•°**ï¼š `Value` (Boolean)ï¼šè®¾ç½®ä¸º `True` å¯ç”¨ JavaScriptï¼Œ`False` ç¦ç”¨ JavaScriptã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php ' ç¦ç”¨ JavaScript æ‰§è¡Œ WebView21.IsScriptEnabled False ' å¯ç”¨ JavaScript æ‰§è¡Œ WebView21.IsScriptEnabled True ``` #### **2. IsWebMessageEnabled** **åŠŸèƒ½è¯´æ˜**ï¼šæ§åˆ¶æ˜¯å¦å¯ç”¨ `PostWebMessage` åŠŸèƒ½ï¼Œä½¿ WebView2 å¯ä»¥ä¸ JavaScript ç«¯è¿›è¡Œæ¶ˆæ¯ä¼ é€’ã€‚è®¾ç½®ä¸º `True` å¯ç”¨æ¶ˆæ¯ä¼ é€’ã€‚ **å‚æ•°**ï¼š `Value` (Boolean)ï¼šè®¾ç½®ä¸º `True` å¯ç”¨æ¶ˆæ¯ä¼ é€’ï¼Œ`False` ç¦ç”¨æ¶ˆæ¯ä¼ é€’ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php ' å¯ç”¨ WebMessage åŠŸèƒ½ WebView21.IsWebMessageEnabled True ' ç¦ç”¨ WebMessage åŠŸèƒ½ WebView21.IsWebMessageEnabled False ``` #### **3. AreHostObjectsAllowed** **åŠŸèƒ½è¯´æ˜**ï¼šæ§åˆ¶æ˜¯å¦å…è®¸åœ¨ WebView2 ä¸­æš´éœ²å®¿ä¸»å¯¹è±¡ã€‚å¯ç”¨æ­¤åŠŸèƒ½åï¼ŒJavaScript å¯ä»¥é€šè¿‡ `chrome.webview.hostObjects` è®¿é—®å®¿ä¸»å¯¹è±¡ã€‚ **å‚æ•°**ï¼š `Value` (Boolean)ï¼šè®¾ç½®ä¸º `True` å…è®¸æš´éœ²å®¿ä¸»å¯¹è±¡ï¼Œ`False` ç¦æ­¢æš´éœ²å®¿ä¸»å¯¹è±¡ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php ' å…è®¸æš´éœ²å®¿ä¸»å¯¹è±¡ WebView21.AreHostObjectsAllowed True ' ç¦æ­¢æš´éœ²å®¿ä¸»å¯¹è±¡ WebView21.AreHostObjectsAllowed False ``` #### **4. IsZoomControlEnabled** **åŠŸèƒ½è¯´æ˜**ï¼šæ§åˆ¶æ˜¯å¦å…è®¸ç”¨æˆ·é€šè¿‡å¿«æ·é”®ï¼ˆCtrl + é¼ æ ‡æ»šè½®ã€Ctrl + åŠ å·ã€Ctrl + å‡å·ï¼‰æ¥è°ƒæ•´é¡µé¢ç¼©æ”¾ã€‚è®¾ç½®ä¸º `False` æ—¶ï¼Œç¦ç”¨è¯¥åŠŸèƒ½ã€‚ **å‚æ•°**ï¼š `Value` (Boolean)ï¼šè®¾ç½®ä¸º `True` å¯ç”¨ç¼©æ”¾æ§åˆ¶ï¼Œ`False` ç¦ç”¨ç¼©æ”¾æ§åˆ¶ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php ' å¯ç”¨ç¼©æ”¾æ§åˆ¶ WebView21.IsZoomControlEnabled True ' ç¦ç”¨ç¼©æ”¾æ§åˆ¶ WebView21.IsZoomControlEnabled False ``` #### **5. IsBuiltInErrorPageEnabled** **åŠŸèƒ½è¯´æ˜**ï¼šæ§åˆ¶æ˜¯å¦å¯ç”¨ WebView2 å†…ç½®çš„é”™è¯¯é¡µé¢ï¼ˆå¦‚ 404 é¡µé¢ï¼‰ã€‚å¦‚æœç¦ç”¨è¯¥åŠŸèƒ½ï¼ŒWebView2 ä¼šæ˜¾ç¤ºç©ºç™½é¡µé¢æˆ–å¼€å‘è€…æä¾›çš„é”™è¯¯é¡µé¢ã€‚ **å‚æ•°**ï¼š `Value` (Boolean)ï¼šè®¾ç½®ä¸º `True` å¯ç”¨å†…ç½®é”™è¯¯é¡µé¢ï¼Œ`False` ç¦ç”¨å†…ç½®é”™è¯¯é¡µé¢ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php ' å¯ç”¨å†…ç½®é”™è¯¯é¡µé¢ WebView21.IsBuiltInErrorPageEnabled True ' ç¦ç”¨å†…ç½®é”™è¯¯é¡µé¢ WebView21.IsBuiltInErrorPageEnabled False ``` #### **6. SupportsAcceleratorKeysFeatures** **åŠŸèƒ½è¯´æ˜**ï¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼ŒæŒ‡ç¤º WebView2 æ˜¯å¦æ”¯æŒåŠ é€Ÿé”®åŠŸèƒ½ï¼ˆå¦‚ F5 åˆ·æ–°ï¼‰ã€‚å¦‚æœè¿”å› `True`ï¼Œè¡¨ç¤º WebView2 æ”¯æŒåŠ é€Ÿé”®ã€‚ **å‚æ•°**ï¼šæ— ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php If WebView21.SupportsAcceleratorKeysFeatures Then MsgBox \"æ”¯æŒåŠ é€Ÿé”®åŠŸèƒ½\" Else MsgBox \"ä¸æ”¯æŒåŠ é€Ÿé”®åŠŸèƒ½\" End If ``` #### **7. IsPasswordAutoSaveEnabled** **åŠŸèƒ½è¯´æ˜**ï¼šæ§åˆ¶æ˜¯å¦å¯ç”¨è‡ªåŠ¨ä¿å­˜å¯†ç åŠŸèƒ½ã€‚å¦‚æœå¯ç”¨ï¼ŒWebView2 ä¼šè‡ªåŠ¨ä¿å­˜å’Œå¡«å……è¡¨å•ä¸­çš„å¯†ç ä¿¡æ¯ã€‚ **å‚æ•°**ï¼š `Value` (Boolean)ï¼šè®¾ç½®ä¸º `True` å¯ç”¨å¯†ç è‡ªåŠ¨ä¿å­˜ï¼Œ`False` ç¦ç”¨è¯¥åŠŸèƒ½ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php ' å¯ç”¨å¯†ç è‡ªåŠ¨ä¿å­˜ WebView21.IsPasswordAutoSaveEnabled True ' ç¦ç”¨å¯†ç è‡ªåŠ¨ä¿å­˜ WebView21.IsPasswordAutoSaveEnabled False ``` #### **8. IsGeneralAutoFillEnabled** **åŠŸèƒ½è¯´æ˜**ï¼šæ§åˆ¶æ˜¯å¦å¯ç”¨è‡ªåŠ¨å¡«å……åŠŸèƒ½ã€‚å¦‚æœå¯ç”¨ï¼ŒWebView2 ä¼šè‡ªåŠ¨å¡«å……è¡¨å•ä¸­çš„ä¿¡æ¯ï¼ˆå¦‚ç”¨æˆ·åã€åœ°å€ç­‰ï¼‰ã€‚ **å‚æ•°**ï¼š `Value` (Boolean)ï¼šè®¾ç½®ä¸º `True` å¯ç”¨è¡¨å•è‡ªåŠ¨å¡«å……ï¼Œ`False` ç¦ç”¨è¯¥åŠŸèƒ½ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php ' å¯ç”¨è¡¨å•è‡ªåŠ¨å¡«å…… WebView21.IsGeneralAutoFillEnabled True ' ç¦ç”¨è¡¨å•è‡ªåŠ¨å¡«å…… WebView21.IsGeneralAutoFillEnabled False ``` #### **9. IsPinchZoomEnabled** **åŠŸèƒ½è¯´æ˜**ï¼šæ§åˆ¶æ˜¯å¦å¯ç”¨è§¦æ‘¸è®¾å¤‡ä¸Šçš„æåˆç¼©æ”¾åŠŸèƒ½ã€‚å¯ç”¨åï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨æåˆæ‰‹åŠ¿æ¥æ”¾å¤§æˆ–ç¼©å°é¡µé¢ã€‚ **å‚æ•°**ï¼š `Value` (Boolean)ï¼šè®¾ç½®ä¸º `True` å¯ç”¨æåˆç¼©æ”¾ï¼Œ`False` ç¦ç”¨æåˆç¼©æ”¾ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php ' å¯ç”¨æåˆç¼©æ”¾ WebView21.IsPinchZoomEnabled True ' ç¦ç”¨æåˆç¼©æ”¾ WebView21.IsPinchZoomEnabled False ``` #### **10. IsSwipeNavigationEnabled** **åŠŸèƒ½è¯´æ˜**ï¼šæ§åˆ¶æ˜¯å¦å¯ç”¨è§¦æ‘¸è®¾å¤‡ä¸Šçš„æ»‘åŠ¨å¯¼èˆªåŠŸèƒ½ã€‚å¯ç”¨åï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡æ»‘åŠ¨æ‰‹åŠ¿è¿›è¡Œé¡µé¢å‰è¿›æˆ–åé€€ã€‚ **å‚æ•°**ï¼š `Value` (Boolean)ï¼šè®¾ç½®ä¸º `True` å¯ç”¨æ»‘åŠ¨å¯¼èˆªï¼Œ`False` ç¦ç”¨æ»‘åŠ¨å¯¼èˆªã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php ' å¯ç”¨æ»‘åŠ¨å¯¼èˆª WebView21.IsSwipeNavigationEnabled True ' ç¦ç”¨æ»‘åŠ¨å¯¼èˆª WebView21.IsSwipeNavigationEnabled False ``` ### ä¸‹ä¸€æ­¥ å¦‚æœè¿™äº›åŠŸèƒ½æ§åˆ¶éƒ¨åˆ†æ²¡æœ‰é—®é¢˜ï¼Œæˆ‘ä¼šæ•´ç†æ–‡æ¡£å¹¶å‡†å¤‡æœ€ç»ˆçš„è¾“å‡ºã€‚å¦‚æœä½ æœ‰å…¶ä»–é—®é¢˜æˆ–éœ€è¦è¿›ä¸€æ­¥çš„å¸®åŠ©ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼"},"/tbman/dev/06_DeveloperTools.html":{"title":"å¼€å‘è€…è°ƒè¯•","content":" title: å¼€å‘è€…è°ƒè¯• keywords: VB6/VBA, WebView2æµè§ˆå™¨æ§ä»¶, å¯åšé‡‡é›† desc: VB6/VBAå¯ç”¨çš„WebView2æµè§ˆå™¨æ§ä»¶(å¯åšé‡‡é›†) éå¸¸æ„Ÿè°¢ä½ çš„è€å¿ƒï¼æ¥ä¸‹æ¥æ˜¯ **å¼€å‘è€…å·¥å…·ä¸è°ƒè¯•åŠŸèƒ½éƒ¨åˆ† (Developer Tools and Debugging Features)** çš„æ–‡æ¡£å†…å®¹ã€‚ ### **å¼€å‘è€…å·¥å…·ä¸è°ƒè¯•åŠŸèƒ½éƒ¨åˆ† (Developer Tools and Debugging Features)** #### **1. JsAsyncResult** **åŠŸèƒ½è¯´æ˜**ï¼šå½“ `JsRunAsync` å‡½æ•°æ‰§è¡Œå®Œæˆæ—¶ï¼Œè¯¥äº‹ä»¶ä¼šè¢«è§¦å‘ã€‚å®ƒæä¾›äº† JavaScript æ‰§è¡Œç»“æœçš„å¼‚æ­¥è¿”å›ï¼Œå¯ä»¥é€šè¿‡ `Token` æ¥åŒºåˆ†ä¸åŒçš„è°ƒç”¨ã€‚ **å‚æ•°**ï¼š `Result` (Variant)ï¼šJavaScript æ‰§è¡Œç»“æœï¼Œé€šå¸¸æ˜¯è¿”å›çš„å€¼ã€‚ `Token` (LongLong)ï¼šè°ƒç”¨æ—¶ä¼ é€’çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œä¾¿äºæ ‡è¯†ä¸åŒçš„å¼‚æ­¥è¯·æ±‚ã€‚ `ErrString` (String)ï¼šé”™è¯¯ä¿¡æ¯ï¼ˆå¦‚æœå‘ç”Ÿé”™è¯¯ï¼‰ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php Private Sub WebView21_JsAsyncResult(ByVal Result As Variant, Token As LongLong, ErrString As String) If ErrString \"\" Then MsgBox \"JavaScript æ‰§è¡Œç»“æœï¼š\" & Result Else MsgBox \"JavaScript é”™è¯¯ï¼š\" & ErrString End If End Sub ``` #### **2. JsMessage** **åŠŸèƒ½è¯´æ˜**ï¼šå½“ JavaScript ç«¯é€šè¿‡ `window.chrome.webview.postMessage(...)` å‘é€æ¶ˆæ¯æ—¶ï¼Œ`JsMessage` äº‹ä»¶ä¼šè§¦å‘ã€‚æ­¤åŠŸèƒ½éœ€è¦å¯ç”¨ `IsWebMessageEnabled`ã€‚ **å‚æ•°**ï¼š `Message` (Variant)ï¼šæ¥è‡ª JavaScript çš„æ¶ˆæ¯å†…å®¹ï¼Œå¯ä»¥æ˜¯ä»»æ„ç±»å‹çš„æ•°æ®ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php Private Sub WebView21_JsMessage(ByVal Message As Variant) MsgBox \"æ”¶åˆ°æ¥è‡ª JavaScript çš„æ¶ˆæ¯ï¼š\" & Message End Sub ``` #### **3. DevToolsProtocolResponse** **åŠŸèƒ½è¯´æ˜**ï¼šå½“é€šè¿‡ `CallDevToolsProtocolMethod` è°ƒç”¨å¼€å‘è€…å·¥å…·åè®®æ–¹æ³•æ—¶ï¼Œ`DevToolsProtocolResponse` äº‹ä»¶ä¼šæ¥æ”¶åˆ°æ–¹æ³•çš„å“åº”ã€‚ **å‚æ•°**ï¼š `CustomEventId` (Variant)ï¼šè‡ªå®šä¹‰çš„äº‹ä»¶ IDï¼Œç”¨äºå…³è”å“åº”ã€‚ `JsonResponse` (String)ï¼šå¼€å‘è€…å·¥å…·åè®®æ–¹æ³•çš„ JSON å“åº”ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php Private Sub WebView21_DevToolsProtocolResponse(ByVal CustomEventId As Variant, ByVal JsonResponse As String) MsgBox \"DevTools å“åº”ï¼š\" & JsonResponse End Sub ``` #### **4. OpenDevToolsWindow** **åŠŸèƒ½è¯´æ˜**ï¼šæ‰“å¼€ WebView2 çš„å¼€å‘è€…å·¥å…·çª—å£ã€‚å¯ä»¥ç”¨äºè°ƒè¯•å’ŒæŸ¥çœ‹é¡µé¢å†…éƒ¨å†…å®¹ã€‚ **å‚æ•°**ï¼šæ— ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php WebView21.OpenDevToolsWindow() ``` #### **5. CallDevToolsProtocolMethod** **åŠŸèƒ½è¯´æ˜**ï¼šé€šè¿‡è°ƒç”¨ WebView2 çš„å¼€å‘è€…å·¥å…·åè®®æ–¹æ³•æ¥ä¸æµè§ˆå™¨è¿›è¡Œäº¤äº’ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ç¦ç”¨è„šæœ¬æ‰§è¡Œã€æ¨¡æ‹Ÿè®¾å¤‡ç¯å¢ƒç­‰ã€‚ **å‚æ•°**ï¼š `MethodName` (String)ï¼šåè®®æ–¹æ³•åç§°ï¼ˆå¦‚ `Emulation.setScriptExecutionDisabled`ï¼‰ã€‚ `ParamsAsJson` (String)ï¼šä»¥ JSON æ ¼å¼ä¼ é€’çš„å‚æ•°ã€‚ `CustomEventId` (Variant)ï¼šå¯é€‰çš„è‡ªå®šä¹‰äº‹ä»¶ IDï¼Œç”¨äºå…³è”å“åº”ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php WebView21.CallDevToolsProtocolMethod(\"Emulation.setScriptExecutionDisabled\", \"{\"\"value\"\":true}\") ``` #### **6. JsRunAsync** **åŠŸèƒ½è¯´æ˜**ï¼šå¼‚æ­¥æ‰§è¡Œ JavaScript ä»£ç ï¼Œå¹¶è¿”å›ä¸€ä¸ªå”¯ä¸€çš„ `Token` æ¥æ ‡è¯†è¯¥å¼‚æ­¥æ‰§è¡Œã€‚æ‰§è¡Œå®Œæˆåï¼Œ`JsAsyncResult` äº‹ä»¶ä¼šè§¦å‘è¿”å›ç»“æœã€‚ **å‚æ•°**ï¼š `FuncName` (String)ï¼šè¦æ‰§è¡Œçš„ JavaScript å‡½æ•°åç§°ã€‚ `args()` (Variant)ï¼šå¯å˜å‚æ•°ï¼Œä¼ é€’ç»™ JavaScript å‡½æ•°çš„å‚æ•°ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php Dim Token As LongLong Token WebView21.JsRunAsync(\"myFunction\", \"param1\", \"param2\") MsgBox \"å¼‚æ­¥è°ƒç”¨çš„ Tokenï¼š\" & Token ``` #### **7. JsRun** **åŠŸèƒ½è¯´æ˜**ï¼šæ‰§è¡Œ JavaScript å‡½æ•°å¹¶ç­‰å¾…ç»“æœè¿”å›ã€‚é€‚ç”¨äºéœ€è¦åŒæ­¥è¿”å›ç»“æœçš„æƒ…å†µã€‚ **å‚æ•°**ï¼š `FuncName` (String)ï¼šè¦æ‰§è¡Œçš„ JavaScript å‡½æ•°åç§°ã€‚ `args()` (Variant)ï¼šå¯å˜å‚æ•°ï¼Œä¼ é€’ç»™ JavaScript å‡½æ•°çš„å‚æ•°ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php Dim result As Variant result WebView21.JsRun(\"sum\", 5, 10) MsgBox \"æ‰§è¡Œç»“æœï¼š\" & result ' è¾“å‡º 15 ``` ### ä¸‹ä¸€æ­¥ è¿™éƒ¨åˆ†æ˜¯ WebView2 çš„å¼€å‘è€…å·¥å…·å’Œè°ƒè¯•åŠŸèƒ½çš„ä»‹ç»ã€‚å¦‚æœè¿™ä¸€éƒ¨åˆ†æ²¡æœ‰é—®é¢˜ï¼Œæˆ‘å°†æ•´ç†å¹¶æä¾›æœ€ç»ˆçš„å®Œæ•´æ–‡æ¡£ã€‚"},"/tbman/README_EN.html":{"title":"TBMAN âœ¨ â€“ A Rapid Development Toolkit for TwinBasic Developers","content":"# TBMAN âœ¨ â€“ A Rapid Development Toolkit for TwinBasic Developers ## âœ¨ What is TBMAN? TBMAN is a rapid development toolkit designed for TwinBasic developers. It defines a series of comprehensive functions and objects to reduce the amount of code developers need to write and improve reusability, enabling them to complete their projects faster and more efficiently. This project offers practical tools and continues to expand and upgrade. âš¡ The project originates from a VB6 library named vbman, which is a rapid server framework based on VB6. It is currently free to use but not open source. For more details, refer to the original project link: [âœ”ï¸ VBMAN: A Rapid Server Framework Based on VB6](https://vb6.pro/vbman) ## ğŸ’Œ Why Choose TBMAN? ### ğŸ“š Advantage 1: Lower Development Costs TBMAN automates many development tasks by defining and integrating numerous general purpose functions, significantly reducing the time spent writing repetitive code. ### ğŸ› ï¸ Advantage 2: Improved Reusability The design of TBMANâ€™s framework considers diverse application scenarios, allowing it to adapt quickly to different projects. ### ğŸ”§ Advantage 3: Continuous Expansion TBMAN is built with a modular and component based design, enabling unlimited extensions and Will bring more efficient tools. ## âš¡ Installation and Usage **Installation** 1. Download the TBMAN package from the project homepage, and import the `TBMANLIB_*.twinpack` file from the `build` directory into your project. 2. Alternatively, you can directly include `TBMANLIB` in your project using the package manager in the TwinBasic IDE **(recommended)**. **Usage** Refer to the demo source code or read the documentation at [https://doc.twinbasic.com.cn/](https://doc.twinbasic.com.cn/). ## ğŸ•µï¸â€â™‚ï¸ Feature List ### Key Features 1. ğŸŒ **Web Utility Functions**: Supports rapid message parsing, HTTP request handling, and more. 2. ğŸ“Š **Data Operation Interfaces**: Provides consistent and practical data input/output interfaces. 3. ğŸ’¡ **Intelligent Tools**: Automates code generation, reducing development difficulty(I am thinking...). ## ğŸ† Focused and Comprehensive Core Features"},"/tbman/start/ChangeLog.html":{"title":"æ›´æ–°æ—¥å¿—","content":" title: æ›´æ–°æ—¥å¿— keywords: VB6/VBA, WebView2æµè§ˆå™¨æ§ä»¶, å¯åšé‡‡é›† desc: VB6/VBAå¯ç”¨çš„WebView2æµè§ˆå™¨æ§ä»¶(å¯åšé‡‡é›†) ### 2024 12 07 v1.0.7 [+] cHttpClient ### 2024 12 07 v1.0.0 Publish"},"/tbman/start/Install.html":{"title":"å®‰è£…æŒ‡å¼•","content":" title: å®‰è£…æŒ‡å¼• keywords: VB6/VBA, WebView2æµè§ˆå™¨æ§ä»¶, å¯åšé‡‡é›† desc: VB6/VBAå¯ç”¨çš„WebView2æµè§ˆå™¨æ§ä»¶(å¯åšé‡‡é›†) ### ä¸‹è½½ç»„ä»¶ğŸ æš‚æ—¶æ²¡æœ‰æ—¶é—´å†™è¯¦ç»†å®‰è£…æ‰‹å†Œï¼Œç›´æ¥ä¸‹è½½ç»„ä»¶ä½¿ç”¨å§ï¼ ğŸ”— **ç«‹å³ä½“éªŒ**ï¼š[ç‚¹å‡»è¿™é‡Œä¸‹è½½ tbman](https://github.com/woeoio/tbman) ### è‡ªå¸¦åŸºç¡€ç¤ºä¾‹ [ç‚¹å‡»è¿™é‡Œä¸‹è½½ ç¤ºä¾‹](https://github.com/woeoio/tbman)"},"/tbman/start/KnownIssues.html":{"title":"å·²çŸ¥é—®é¢˜","content":" title: å·²çŸ¥é—®é¢˜ keywords: VB6/VBA, WebView2æµè§ˆå™¨æ§ä»¶, å¯åšé‡‡é›† desc: VB6/VBAå¯ç”¨çš„WebView2æµè§ˆå™¨æ§ä»¶(å¯åšé‡‡é›†) æš‚æ— ç¼–å†™..."},"/tbman/dev/07_AdvancedSettings.html":{"title":"é«˜çº§è®¾ç½®","content":" title: é«˜çº§è®¾ç½® keywords: VB6/VBA, WebView2æµè§ˆå™¨æ§ä»¶, å¯åšé‡‡é›† desc: VB6/VBAå¯ç”¨çš„WebView2æµè§ˆå™¨æ§ä»¶(å¯åšé‡‡é›†) æ„Ÿè°¢ä½ çš„è€å¿ƒï¼ç°åœ¨æ˜¯ **æ§åˆ¶åŠŸèƒ½ä¸é«˜çº§è®¾ç½®éƒ¨åˆ† (Control Features & Advanced Settings)** çš„æ–‡æ¡£å†…å®¹ã€‚ ### **æ§åˆ¶åŠŸèƒ½ä¸é«˜çº§è®¾ç½®éƒ¨åˆ† (Control Features & Advanced Settings)** #### **1. AreDefaultContextMenusEnabled** **åŠŸèƒ½è¯´æ˜**ï¼šæ§åˆ¶æ˜¯å¦å¯ç”¨é»˜è®¤çš„ä¸Šä¸‹æ–‡èœå•ï¼ˆå³é”®èœå•ï¼‰ã€‚å¦‚æœç¦ç”¨ï¼Œå¯ä»¥é€šè¿‡ `UserContextMenu` äº‹ä»¶æ¥è‡ªå®šä¹‰å³é”®èœå•ã€‚ **å‚æ•°**ï¼š `Value` (Boolean)ï¼šè®¾ç½®ä¸º `True` å¯ç”¨é»˜è®¤ä¸Šä¸‹æ–‡èœå•ï¼Œ`False` ç¦ç”¨é»˜è®¤ä¸Šä¸‹æ–‡èœå•ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php ' ç¦ç”¨é»˜è®¤ä¸Šä¸‹æ–‡èœå• WebView21.AreDefaultContextMenusEnabled False ' å¯ç”¨é»˜è®¤ä¸Šä¸‹æ–‡èœå• WebView21.AreDefaultContextMenusEnabled True ``` #### **2. AreBrowserAcceleratorKeysEnabled** **åŠŸèƒ½è¯´æ˜**ï¼šæ§åˆ¶æ˜¯å¦å¯ç”¨æµè§ˆå™¨åŠ é€Ÿé”®ï¼ˆå¦‚ F5 åˆ·æ–°ã€Ctrl+T æ–°æ ‡ç­¾é¡µï¼‰ã€‚å¯ç”¨æ—¶ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨è¿™äº›å¿«æ·é”®è¿›è¡Œå¸¸è§æ“ä½œã€‚ **å‚æ•°**ï¼š `Value` (Boolean)ï¼šè®¾ç½®ä¸º `True` å¯ç”¨æµè§ˆå™¨åŠ é€Ÿé”®ï¼Œ`False` ç¦ç”¨åŠ é€Ÿé”®ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php ' ç¦ç”¨æµè§ˆå™¨åŠ é€Ÿé”® WebView21.AreBrowserAcceleratorKeysEnabled False ' å¯ç”¨æµè§ˆå™¨åŠ é€Ÿé”® WebView21.AreBrowserAcceleratorKeysEnabled True ``` #### **3. SupportsPdfFeatures** **åŠŸèƒ½è¯´æ˜**ï¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼ŒæŒ‡ç¤º WebView2 æ˜¯å¦æ”¯æŒ PDF åŠŸèƒ½ã€‚å¯ç”¨æ—¶ï¼ŒWebView2 å¯ä»¥ç›´æ¥å±•ç¤º PDF æ–‡ä»¶ã€‚ **å‚æ•°**ï¼šæ— ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php If WebView21.SupportsPdfFeatures Then MsgBox \"æ”¯æŒ PDF åŠŸèƒ½\" Else MsgBox \"ä¸æ”¯æŒ PDF åŠŸèƒ½\" End If ``` #### **4. IsPinchZoomEnabled** **åŠŸèƒ½è¯´æ˜**ï¼šæ§åˆ¶æ˜¯å¦å¯ç”¨è§¦æ‘¸è®¾å¤‡ä¸Šçš„æåˆç¼©æ”¾åŠŸèƒ½ã€‚å¯ç”¨åï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡æåˆæ‰‹åŠ¿è¿›è¡Œé¡µé¢ç¼©æ”¾ã€‚ **å‚æ•°**ï¼š `Value` (Boolean)ï¼šè®¾ç½®ä¸º `True` å¯ç”¨æåˆç¼©æ”¾ï¼Œ`False` ç¦ç”¨æåˆç¼©æ”¾ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php ' å¯ç”¨æåˆç¼©æ”¾ WebView21.IsPinchZoomEnabled True ' ç¦ç”¨æåˆç¼©æ”¾ WebView21.IsPinchZoomEnabled False ``` #### **5. SupportsAutoFillFeatures** **åŠŸèƒ½è¯´æ˜**ï¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼ŒæŒ‡ç¤º WebView2 æ˜¯å¦æ”¯æŒè‡ªåŠ¨å¡«å……åŠŸèƒ½ã€‚å¦‚æœè¿”å› `True`ï¼Œè¡¨ç¤º WebView2 æ”¯æŒè‡ªåŠ¨å¡«å……ï¼ˆå¦‚è‡ªåŠ¨å¡«å†™è¡¨å•ä¸­çš„ç”¨æˆ·åå’Œå¯†ç ï¼‰ã€‚ **å‚æ•°**ï¼šæ— ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php If WebView21.SupportsAutoFillFeatures Then MsgBox \"æ”¯æŒè‡ªåŠ¨å¡«å……åŠŸèƒ½\" Else MsgBox \"ä¸æ”¯æŒè‡ªåŠ¨å¡«å……åŠŸèƒ½\" End If ``` #### **6. AreHostObjectsAllowed** **åŠŸèƒ½è¯´æ˜**ï¼šæ§åˆ¶æ˜¯å¦å…è®¸ WebView2 ä½¿ç”¨å®¿ä¸»å¯¹è±¡ï¼ˆå¦‚ COM å¯¹è±¡ï¼‰ã€‚å¦‚æœè®¾ç½®ä¸º `True`ï¼ŒJavaScript å¯ä»¥è®¿é—®å’Œè°ƒç”¨å®¿ä¸»å¯¹è±¡çš„æ–¹æ³•ã€‚ **å‚æ•°**ï¼š `Value` (Boolean)ï¼šè®¾ç½®ä¸º `True` å…è®¸ä½¿ç”¨å®¿ä¸»å¯¹è±¡ï¼Œ`False` ç¦æ­¢ä½¿ç”¨å®¿ä¸»å¯¹è±¡ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php ' å¯ç”¨å®¿ä¸»å¯¹è±¡ WebView21.AreHostObjectsAllowed True ' ç¦ç”¨å®¿ä¸»å¯¹è±¡ WebView21.AreHostObjectsAllowed False ``` #### **7. SupportsFolderMappingFeatures** **åŠŸèƒ½è¯´æ˜**ï¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼ŒæŒ‡ç¤º WebView2 æ˜¯å¦æ”¯æŒæ–‡ä»¶å¤¹æ˜ å°„åŠŸèƒ½ã€‚å¦‚æœè¿”å› `True`ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ `SetVirtualHostNameToFolderMapping` è®¾ç½®ä¸»æœºååˆ°æ–‡ä»¶å¤¹çš„æ˜ å°„ã€‚ **å‚æ•°**ï¼šæ— ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php If WebView21.SupportsFolderMappingFeatures Then MsgBox \"æ”¯æŒæ–‡ä»¶å¤¹æ˜ å°„åŠŸèƒ½\" Else MsgBox \"ä¸æ”¯æŒæ–‡ä»¶å¤¹æ˜ å°„åŠŸèƒ½\" End If ``` #### **8. IsStatusBarEnabled** **åŠŸèƒ½è¯´æ˜**ï¼šæ§åˆ¶æ˜¯å¦å¯ç”¨ WebView2 çš„çŠ¶æ€æ ã€‚å¯ç”¨æ—¶ï¼ŒWebView2 ä¼šæ˜¾ç¤ºçŠ¶æ€æ ï¼Œç”¨äºæ˜¾ç¤ºé¡µé¢çŠ¶æ€æˆ–åŠ è½½è¿›åº¦ç­‰ä¿¡æ¯ã€‚ **å‚æ•°**ï¼š `Value` (Boolean)ï¼šè®¾ç½®ä¸º `True` å¯ç”¨çŠ¶æ€æ ï¼Œ`False` ç¦ç”¨çŠ¶æ€æ ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php ' å¯ç”¨çŠ¶æ€æ  WebView21.IsStatusBarEnabled True ' ç¦ç”¨çŠ¶æ€æ  WebView21.IsStatusBarEnabled False ``` #### **9. SupportsTaskManagerFeatures** **åŠŸèƒ½è¯´æ˜**ï¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼ŒæŒ‡ç¤º WebView2 æ˜¯å¦æ”¯æŒä»»åŠ¡ç®¡ç†å™¨åŠŸèƒ½ã€‚å¦‚æœè¿”å› `True`ï¼Œåˆ™å¯ä»¥é€šè¿‡ `OpenTaskManagerWindow` æ‰“å¼€ WebView2 çš„å†…ç½®ä»»åŠ¡ç®¡ç†å™¨ã€‚ **å‚æ•°**ï¼šæ— ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php If WebView21.SupportsTaskManagerFeatures Then MsgBox \"æ”¯æŒä»»åŠ¡ç®¡ç†å™¨åŠŸèƒ½\" Else MsgBox \"ä¸æ”¯æŒä»»åŠ¡ç®¡ç†å™¨åŠŸèƒ½\" End If ``` #### **10. SupportsAcceleratorKeysFeatures** **åŠŸèƒ½è¯´æ˜**ï¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼ŒæŒ‡ç¤º WebView2 æ˜¯å¦æ”¯æŒæµè§ˆå™¨åŠ é€Ÿé”®åŠŸèƒ½ï¼ˆå¦‚ F5 åˆ·æ–°ã€Ctrl+T æ–°æ ‡ç­¾é¡µç­‰ï¼‰ã€‚ **å‚æ•°**ï¼šæ— ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php If WebView21.SupportsAcceleratorKeysFeatures Then MsgBox \"æ”¯æŒåŠ é€Ÿé”®åŠŸèƒ½\" Else MsgBox \"ä¸æ”¯æŒåŠ é€Ÿé”®åŠŸèƒ½\" End If ``` ### ä¸‹ä¸€æ­¥ è¿™éƒ¨åˆ†æ˜¯ WebView2 æ§åˆ¶åŠŸèƒ½å’Œé«˜çº§è®¾ç½®çš„ä»‹ç»ã€‚å¦‚æœè¿™éƒ¨åˆ†æ²¡æœ‰é—®é¢˜ï¼Œæˆ‘å°†è¿›è¡Œæœ€åçš„æ–‡æ¡£æ•´ç†å¹¶å‡†å¤‡æœ€ç»ˆçš„è¾“å‡ºã€‚"},"/tbman/dev/08_OtherFeatures.html":{"title":"å…¶ä»–åŠŸèƒ½","content":" title: å…¶ä»–åŠŸèƒ½ keywords: VB6/VBA, WebView2æµè§ˆå™¨æ§ä»¶, å¯åšé‡‡é›† desc: VB6/VBAå¯ç”¨çš„WebView2æµè§ˆå™¨æ§ä»¶(å¯åšé‡‡é›†) éå¸¸æ„Ÿè°¢ä½ çš„è€å¿ƒï¼æˆ‘ä»¬å·²å®Œæˆäº†å¤§éƒ¨åˆ†æ–‡æ¡£å†…å®¹ã€‚æ¥ä¸‹æ¥æ˜¯ **æ€»ç»“ä¸å…¶ä»–åŠŸèƒ½éƒ¨åˆ† (Summary & Other Features)** çš„æ–‡æ¡£å†…å®¹ã€‚ ### **æ€»ç»“ä¸å…¶ä»–åŠŸèƒ½éƒ¨åˆ† (Summary & Other Features)** #### **1. UserContextMenu** **åŠŸèƒ½è¯´æ˜**ï¼šå½“ç”¨æˆ·å³å‡» WebView2 æ§ä»¶æ—¶è§¦å‘è¯¥äº‹ä»¶ã€‚å¦‚æœç¦ç”¨äº†é»˜è®¤ä¸Šä¸‹æ–‡èœå• (`AreDefaultContextMenusEnabled False`)ï¼Œåˆ™å¯ä»¥é€šè¿‡æ­¤äº‹ä»¶è‡ªå®šä¹‰å³é”®èœå•ã€‚ **å‚æ•°**ï¼š `X` (Single)ï¼šå³é”®ç‚¹å‡»æ—¶çš„ X åæ ‡ã€‚ `Y` (Single)ï¼šå³é”®ç‚¹å‡»æ—¶çš„ Y åæ ‡ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php Private Sub WebView21_UserContextMenu(X As Single, Y As Single) MsgBox \"ç”¨æˆ·å³é”®ç‚¹å‡»ä½ç½®ï¼šX \" & X & \", Y \" & Y End Sub ``` #### **2. ScriptDialogOpening** **åŠŸèƒ½è¯´æ˜**ï¼šå½“ `AreDefaultScriptDialogsEnabled` è®¾ç½®ä¸º `False` æ—¶ï¼ŒJavaScript ä¸­çš„ `alert()`, `confirm()`, `prompt()` ç­‰é»˜è®¤å¯¹è¯æ¡†ä¼šè¢«æ‹¦æˆªï¼Œå¹¶è§¦å‘è¯¥äº‹ä»¶ã€‚å¯ä»¥é€šè¿‡æ­¤äº‹ä»¶è‡ªå®šä¹‰å¯¹è¯æ¡†ã€‚ **å‚æ•°**ï¼š `ScriptDialogKind` (wv2ScriptDialogKind)ï¼šè„šæœ¬å¯¹è¯æ¡†çš„ç±»å‹ï¼ˆå¦‚ `alert`ã€`confirm` ç­‰ï¼‰ã€‚ `Accept` (ByRef Boolean)ï¼šè®¾ç½®ä¸º `True` å¯æ¥å—å¯¹è¯æ¡†ï¼Œ`False` å¯æ‹’ç»å¯¹è¯æ¡†ã€‚ `ResultText` (String)ï¼šç”¨äºæ¥æ”¶ç”¨æˆ·è¾“å…¥çš„æ–‡æœ¬ã€‚ `URI` (String)ï¼šè§¦å‘å¯¹è¯æ¡†çš„ URLã€‚ `Message` (String)ï¼šå¯¹è¯æ¡†ä¸­çš„æ¶ˆæ¯ã€‚ `DefaultText` (String)ï¼šå¯¹è¯æ¡†ä¸­çš„é»˜è®¤æ–‡æœ¬ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php Private Sub WebView21_ScriptDialogOpening(ByVal ScriptDialogKind As wv2ScriptDialogKind, ByRef Accept As Boolean, ByVal ResultText As String, ByVal URI As String, ByVal Message As String, ByVal DefaultText As String) MsgBox \"è‡ªå®šä¹‰è„šæœ¬å¯¹è¯æ¡†: \" & Message Accept True ' æ¥å—å¯¹è¯æ¡† End Sub ``` #### **3. SuspendCompleted** **åŠŸèƒ½è¯´æ˜**ï¼šåœ¨è°ƒç”¨ `Suspend` æ–¹æ³•æˆåŠŸåè§¦å‘çš„äº‹ä»¶ï¼Œè¡¨ç¤º WebView2 å·²æˆåŠŸæš‚åœå…¶å¤„ç†å’Œæ¸²æŸ“ã€‚ **å‚æ•°**ï¼šæ— ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php Private Sub WebView21_SuspendCompleted() MsgBox \"WebView2 å·²æˆåŠŸæš‚åœ\" End Sub ``` #### **4. SuspendFailed** **åŠŸèƒ½è¯´æ˜**ï¼šåœ¨è°ƒç”¨ `Suspend` æ–¹æ³•å¤±è´¥æ—¶è§¦å‘çš„äº‹ä»¶ã€‚ **å‚æ•°**ï¼šæ— ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php Private Sub WebView21_SuspendFailed() MsgBox \"WebView2 æš‚åœå¤±è´¥\" End Sub ``` #### **5. NewWindowRequested** **åŠŸèƒ½è¯´æ˜**ï¼šå½“ WebView2 å°è¯•æ‰“å¼€ä¸€ä¸ªæ–°çª—å£æ—¶è§¦å‘æ­¤äº‹ä»¶ã€‚é€šè¿‡è®¾ç½® `IsHandled True`ï¼Œå¯ä»¥é˜»æ­¢ WebView2 é»˜è®¤è¡Œä¸ºï¼Œæ”¹ä¸ºè‡ªå®šä¹‰çª—å£æ‰“å¼€ã€‚ **å‚æ•°**ï¼š `IsUserInitiated` (Boolean)ï¼šæ˜¯å¦ä¸ºç”¨æˆ·è§¦å‘ã€‚ `IsHandled` (ByRef Boolean)ï¼šå¦‚æœè®¾ç½®ä¸º `True`ï¼Œåˆ™ WebView2 ä¸ä¼šæ‰“å¼€æ–°çª—å£ã€‚ `Uri` (String)ï¼šè¯·æ±‚çš„æ–° URLã€‚ `HasPosition`ã€`HasSize`ã€`Left`ã€`Top`ã€`Width`ã€`Height` (Long)ï¼šæ–°çª—å£çš„ä½ç½®å’Œå¤§å°ã€‚ `ShouldDisplayMenuBar`ã€`ShouldDisplayStatus`ã€`ShouldDisplayToolbar`ã€`ShouldDisplayScrollBars` (Long)ï¼šæ–°çª—å£çš„åŠŸèƒ½è®¾ç½®ã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php Private Sub WebView21_NewWindowRequested(ByVal IsUserInitiated As Boolean, ByRef IsHandled As Boolean, ByVal Uri As String, ByVal HasPosition As Long, ByVal HasSize As Long, ByVal Left As Long, ByVal Top As Long, ByVal Width As Long, ByVal Height As Long, ByVal ShouldDisplayMenuBar As Long, ByVal ShouldDisplayStatus As Long, ByVal ShouldDisplayToolbar As Long, ByVal ShouldDisplayScrollBars As Long) MsgBox \"æ–°çª—å£è¯·æ±‚: \" & Uri IsHandled True ' é˜»æ­¢é»˜è®¤æ‰“å¼€æ–°çª—å£ End Sub ``` #### **6. DownloadStarting** **åŠŸèƒ½è¯´æ˜**ï¼šåœ¨ç”¨æˆ·ç‚¹å‡»ä¸‹è½½é“¾æ¥æ—¶è§¦å‘æ­¤äº‹ä»¶ã€‚å¯ä»¥åœ¨æ­¤äº‹ä»¶ä¸­ä¿®æ”¹ä¸‹è½½è·¯å¾„æˆ–å–æ¶ˆä¸‹è½½ã€‚ **å‚æ•°**ï¼š `ResultFilePath` (ByRef String)ï¼šä¸‹è½½çš„ç›®æ ‡æ–‡ä»¶è·¯å¾„ã€‚ `Cancel` (ByRef Boolean)ï¼šè®¾ç½®ä¸º `True` å¯å–æ¶ˆä¸‹è½½ã€‚ `Handled` (ByRef Boolean)ï¼šè®¾ç½®ä¸º `True` å¤„ç†ä¸‹è½½ï¼Œ`False` ä½¿ç”¨é»˜è®¤è¡Œä¸ºã€‚ **ç¤ºä¾‹ä»£ç **ï¼š ```php Private Sub WebView21_DownloadStarting(ByRef ResultFilePath As String, ByRef Cancel As Boolean, ByRef Handled As Boolean) MsgBox \"ä¸‹è½½å¼€å§‹ï¼Œç›®æ ‡æ–‡ä»¶è·¯å¾„: \" & ResultFilePath ' å¯ä¿®æ”¹æ–‡ä»¶è·¯å¾„æˆ–å–æ¶ˆä¸‹è½½ ResultFilePath \"C:\\NewPath\\DownloadedFile.exe\" Cancel False ' å…è®¸ä¸‹è½½ç»§ç»­ Handled True ' å¤„ç†äº†ä¸‹è½½ End Sub ``` ### æœ€åæ•´ç†ä¸è¾“å‡º æ‰€æœ‰å†…å®¹å·²ç»æ•´ç†å®Œæ¯•ï¼æ–‡æ¡£æ¶µç›–äº†äº‹ä»¶ã€æ–¹æ³•ã€å±æ€§ã€æ§åˆ¶åŠŸèƒ½ã€å¼€å‘è€…å·¥å…·ã€è°ƒè¯•åŠŸèƒ½å’Œå…¶ä»–ç‰¹æ€§ç­‰æ–¹é¢ï¼Œå·²å®Œæ•´å®Œæˆã€‚ **æ¥ä¸‹æ¥çš„æ­¥éª¤**ï¼š æˆ‘ä¼šå°†æ•´ä¸ªæ–‡æ¡£æ•´ç†æˆä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶æä¾›ç»™ä½ ä¸‹è½½ã€‚ å¦‚æœä½ éœ€è¦ï¼Œæˆ‘å¯ä»¥ç»§ç»­å‹ç¼©å¹¶æä¾›æ–‡ä»¶ä¸‹è½½é“¾æ¥ã€‚ å¦‚æœæ²¡æœ‰å…¶ä»–é—®é¢˜ï¼Œæˆ‘å°†ç«‹å³å‡†å¤‡æ–‡ä»¶å¹¶é€šçŸ¥ä½ ã€‚"},"/tbman/dev/hello.html":{"title":"å¿«é€Ÿå¼€å§‹","content":" title: å¿«é€Ÿå¼€å§‹ keywords: VB6/VBA, WebView2æµè§ˆå™¨æ§ä»¶, å¯åšé‡‡é›† desc: VB6/VBAå¯ç”¨çš„WebView2æµè§ˆå™¨æ§ä»¶(å¯åšé‡‡é›†) è¯·å…ˆçœ‹demoæºç ..."},"/tbman/dev/more.html":{"title":"æ•¬è¯·æœŸå¾…","content":" title: æ•¬è¯·æœŸå¾… keywords: VB6/VBA, WebView2æµè§ˆå™¨æ§ä»¶, å¯åšé‡‡é›† desc: VB6/VBAå¯ç”¨çš„WebView2æµè§ˆå™¨æ§ä»¶(å¯åšé‡‡é›†) æ•¬è¯·æœŸå¾…..."},"/tbman/index.html":{"title":"TBMAN ","content":"# TBMAN TBMANâœ¨ â€“ ä¸º TwinBasic å¼€å‘è€…æä¾›çš„å¿«é€Ÿå¼€å‘å·¥å…·é›†åˆ ## âœ¨ ä»€ä¹ˆæ˜¯ TBMANï¼Ÿ TBMANæ˜¯ä¸€ä¸ªé¢å‘ TwinBasic å¼€å‘è€…è®¾è®¡çš„å¿«é€Ÿå¼€å‘å·¥å…·é›†åˆï¼Œå®ƒè‡ªå®šä¹‰äº†ä¸€ç³»åˆ—å®Œå–„çš„å‡½æ•°å’Œå¯¹è±¡ï¼Œç›®çš„æ˜¯é€šè¿‡é™ä½å¼€å‘ä»£ç é‡å’Œæé«˜é‡å¤åˆ©ç”¨ç‡ï¼Œå¸®åŠ©å¼€å‘è€…æ›´å¿«ã€æ›´é«˜æ•ˆåœ°å®Œæˆä»–ä»¬çš„é¡¹ç›®ã€‚è¿™ä¸ªé¡¹ç›®æä¾›äº†å®ç”¨çš„å·¥å…·ï¼Œå¹¶æŒç»­æ‰©å……å’Œå‡çº§ã€‚ âš¡ è¯¥é¡¹ç›®ä¾†æºäº VB6 ä¸Šçš„ä¸€ä¸ªåå«vbmançš„åº“ï¼Œå®ƒæ˜¯åŸºäº VB6 å¼€å‘çš„å¿«é€ŸæœåŠ¡å™¨æ¡†æ¶ï¼Œç°åœ¨å…è´¹ä½¿ç”¨ï¼Œä½†æœªå…¬å¼€æºã€‚æœ‰å…³è¯¦æƒ…ï¼Œå¯ä»¥å‚è€ƒåŸé¡¹ç›®åœ°å€ï¼š [â€âœ”ï¸ VBMANï¼šåŸºäºVB6çš„å¿«é€ŸæœåŠ¡å™¨æ¡†æ¶](https://vb6.pro/vbman) ## ğŸ’¡ ä¸ºä»€ä¹ˆé€‰æ‹© TBMANï¼Ÿ ### ğŸ“š ä¼˜åŠ¿ä¸€ï¼šé™ä½å¼€å‘æˆæœ¬ TBMAN é€šè¿‡å®šä¹‰å¹¶é›†æˆå¤§é‡é€šç”¨å‡½æ•°ï¼Œæé«˜äº†å¼€å‘ä»»åŠ¡çš„è‡ªåŠ¨åŒ–ç¨‹åº¦ï¼Œå¤§å¤§é™ä½ä½ å†™é‡å¤ä»£ç çš„æ—¶é—´ã€‚ ### ğŸ› ï¸ ä¼˜åŠ¿äºŒï¼šæé«˜é‡å¤åˆ©ç”¨ç‡ TBMAN çš„æ¡†æ¶è®¾è®¡åŒæ—¶è€ƒè™‘åˆ°åº”ç”¨åœºæ™¯çš„å¤šæ ·æ€§ï¼Œä½¿å…¶å¯ä»¥å¿«é€Ÿé€‚é…åˆ°ä¸åŒé¡¹ç›®ã€‚ ### ğŸ”§ ä¼˜åŠ¿ä¸‰ï¼šæŒç»­æ‰©å…… TBMAN é‡‡ç”¨æ„ä»¶åŒ–å’Œæ¨¡å—åŒ–è®¾è®¡ï¼Œå¯è¿›è¡Œæ— ç•Œåˆ¶çš„æ‰©å……ï¼Œå°†ä¼šå¸¦æ¥æ›´å¤šé«˜æ•ˆå·¥å…·ã€‚ ## âš¡å®‰è£…å’Œä½¿ç”¨ **å®‰è£…** é¡¹ç›®å¼€æºåœ°å€ï¼š[https://github.com/woeoio/tbman](https://github.com/woeoio/tbman) 1. ä»é¡¹ç›®åœ°å€ä¸‹è½½ TBMAN æ–‡ä»¶åŒ…, æŠŠ build ç›®å½•ä¸‹çš„ TBMANLIB_*.twinpack æ–‡ä»¶å¯¼å…¥ä½ çš„é¡¹ç›®ã€‚ 2. å¦å¤–ä¸€ä¸ªå¯é€‰æ–¹å¼, æ˜¯ç›´æ¥ä» twinbasic ide çš„ åŒ…ç®¡ç†å™¨ å¼•å…¥ TBMANLIB åˆ°é¡¹ç›® `æ¨è`ã€‚ **ä½¿ç”¨** å‚è€ƒdemoæºä»£ç ï¼Œæˆ–è€…é˜…è¯»æ­¤æ–‡æ¡£ ## ğŸ•µï¸â€â™‚ï¸ åŠŸèƒ½åˆ—è¡¨ ### é‡è¦åŠŸèƒ½ 1. ğŸŒ **Web å®ç”¨å‡½æ•°é›†**ï¼šæ”¯æŒå¿«é€Ÿæ¶ˆæ¯è§£æï¼ŒHTTP è¯·æ±‚å¤„ç†ç­‰ã€‚ 2. ğŸ“Š **æ•°æ®æ“ä½œæ¥å£**ï¼šæä¾›ä¸€è‡´å’Œå®ç”¨çš„æ•°æ®è¿›å‡ºæ¥å£ã€‚ 3. ğŸ’¡ **æ™ºèƒ½åŒ–å·¥å…·**ï¼šè‡ªåŠ¨åŒ–ä»£ç ç”Ÿæˆï¼Œé™ä½å¼€å‘éš¾åº¦ï¼ˆæ€è€ƒä¸­ï¼‰ã€‚ ## ğŸ† é‡ç‚¹ç²¾å¿ƒæ ¸å¿ƒæ ¸å®Œå–„é›† ... ## ğŸ’Œ æèµ æœ¬é¡¹ç›® å¦‚æœæœ¬é¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©, æ¬¢è¿æèµ , é¼“åŠ±è¿­ä»£å‘å±•! <div id \"big_btn_wrapper\"> <a class \"btn\" href \"/tbman/about/Donate.html\">ç«‹å³æ‰“èµ</a> </div> ## ğŸ•µï¸â€â™‚ï¸ åŠ å…¥æˆ‘ä»¬ä¸€èµ·äº¤æµ <div> æ¬¢è¿å…¥ç¾¤ï¼š 788160802 <a href \"http://qm.qq.com/cgi bin/qm/qr?_wv 1027&k edaLl 56q2E9PBRuBEZEBwV wvVaEmrz&authKey 0KAufrkYd6U5SsjCqj86o42U9ifEs%2FIYIU8042W4iI8l%2FvqqBdkU64VXyHLpwt4h&noverify 0&group_code 788160802\" target \"_blank\"> ç‚¹å‡»é“¾æ¥åŠ å…¥ç¾¤èŠã€TwinBasicå¼€å‘äº¤æµã€‘ </a> </div>"}}