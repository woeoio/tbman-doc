{"/tbman/about/Collaboration.html":{"title":"协作文档","content":" title: 协作文档 keywords: VB6/VBA, WebView2浏览器控件, 可做采集 desc: VB6/VBA可用的WebView2浏览器控件(可做采集) ## 协作编写此文档 如果你想加入本文档编写，请到这里联系我 [https://github.com/woeoio/tbman doc](https://github.com/woeoio/tbman doc)"},"/tbman/about/Donate.html":{"title":"捐赠","content":" title: 捐赠 keywords: VB6/VBA, WebView2浏览器控件, 可做采集 desc: VB6/VBA可用的WebView2浏览器控件(可做采集) <style> img{ width: 40%; padding: 10px; border: 1px solid; } </style> ## 为项目发电 如果本项目对你有帮助, 欢迎捐赠, 你的慷慨将鼓励迭代发展! ### 使用 Paypal <div id \"big_btn_wrapper\"> <a class \"btn\" href \"https://paypal.me/woeoio2\" target \"_blank\">打开 Paypal 支付首页</a> </div> ### 使用 ko fi <script type 'text/javascript' src 'https://storage.ko fi.com/cdn/widget/Widget_2.js'></script><script type 'text/javascript'>kofiwidget2.init('Buy Me a Coffee', '#870900', 'Y8Y21746Q4');kofiwidget2.draw();</script> ### 使用 微信/支付宝 <div style \"\"> <img src \"/static/img/donate/wx.png\" /> <img style \"width: 35%\" src \"/static/img/donate/zfb.jpg\" /> </div> ## 捐赠英豪榜 (暂无)"},"/tbman/about/OfThanks.html":{"title":"致谢","content":" title: 致谢 keywords: VB6/VBA, WebView2浏览器控件, 可做采集 desc: VB6/VBA可用的WebView2浏览器控件(可做采集) ## 鸣谢： 站在巨人的肩膀上, 使得我们走得更远. 本项目引用了以下开源项目, 在此表示感谢! ### ChatGPT 首先感谢 `openai` 提供的免费版 `ChatGPT` 网页版服务，本文档由此 ai 生成！ ### [VBA JSON v2.3.1] MIT License Copyright (c) 2013 [Tim Hall] From: https://github.com/VBA tools/VBA JSON ### [VbWebserver modMime.bas] MIT License Copyright (c) 2017 Jason Peter Brown <jason@bitspaces.com> From: <? Please tell me ?>"},"/tbman/dev/01_Events.html":{"title":"事件","content":" title: 事件 keywords: VB6/VBA, WebView2浏览器控件, 可做采集 desc: VB6/VBA可用的WebView2浏览器控件(可做采集) 好的，我将分步为你提供文档内容，并确保每个部分都涵盖完整的解释。下面是第一部分——**事件部分**，我会逐个函数提供功能说明、参数说明和示例代码。 ### **事件部分 (Events)** #### **1. Create** **功能说明**：`Create` 事件在 WebView2 控件创建之前触发 **参数**：无 **示例代码**： ```php Private Sub WebView21_Create() MsgBox(\"WebView2 创建中...\") End Sub ``` #### **2. Ready** **功能说明**：`Ready` 事件在 WebView2 控件成功创建并准备好使用时触发。 **参数**：无 **示例代码**： ```php Private Sub WebView21_Ready() MsgBox(\"WebView2 已准备就绪！\") End Sub ``` #### **3. Error** **功能说明**：捕获 WebView2 控件初始化过程中发生的错误。 **参数**： `code` (Long)：错误代码。 `msg` (String)：错误信息。 **示例代码**： ```php Private Sub WebView21_Error(ByVal code As Long, ByVal msg As String) MsgBox(\"错误代码: \" & code & \" 错误信息: \" & msg) End Sub ``` #### **4. NavigationStarting** **功能说明**：`NavigationStarting` 事件在导航开始之前触发，允许开发者在导航前对请求进行修改或取消。 **参数**： `Uri` (String)：导航目标 URL。 `IsUserInitiated` (Boolean)：是否由用户触发导航。 `IsRedirected` (Boolean)：是否为重定向。 `RequestHeaders` (WebView2RequestHeaders)：请求头。 `Cancel` (ByRef Boolean)：设置为 `True` 可取消导航。 **示例代码**： ```php Private Sub WebView21_NavigationStarting(ByVal Uri As String, ByVal IsUserInitiated As Boolean, ByVal IsRedirected As Boolean, ByVal RequestHeaders As Object, ByRef Cancel As Boolean) If Uri \"http://www.blockedwebsite.com\" Then Cancel True MsgBox(\"禁止访问该网站\") End If End Sub ``` #### **5. NavigationComplete** **功能说明**：导航完成后触发该事件。 **参数**： `IsSuccess` (Boolean)：表示导航是否成功。 `WebErrorStatus` (Long)：导航失败时的错误状态码。 **示例代码**： ```php Private Sub WebView21_NavigationComplete(ByVal IsSuccess As Boolean, ByVal WebErrorStatus As Long) If IsSuccess Then MsgBox(\"导航成功完成！\") Else MsgBox(\"导航失败，错误码：\" & WebErrorStatus) End If End Sub ``` #### **6. SourceChanged** **功能说明**：当 `DocumentURL` 属性更新时触发，通常用于页面导航完成后，更新 URL 栏等组件。 **参数**： `IsNewDocument` (Boolean)：是否为新文档。 **示例代码**： ```php Private Sub WebView21_SourceChanged(ByVal IsNewDocument As Boolean) MsgBox(\"当前文档已更改：\" & WebView21.DocumentURL) End Sub ``` ### 下一步 如果这部分内容没有问题，我将继续为你提供方法和属性部分的说明。"},"/tbman/dev/02_Methods.html":{"title":"方法","content":" title: 方法 keywords: VB6/VBA, WebView2浏览器控件, 可做采集 desc: VB6/VBA可用的WebView2浏览器控件(可做采集) 好的！接下来是 **方法部分 (Methods)** 的文档内容。我将继续提供每个方法的功能说明、参数说明和示例代码。 ### **方法部分 (Methods)** #### **1. Navigate** **功能说明**：导航到指定的 URL。 **参数**： `Url` (String)：要导航到的目标 URL。 **示例代码**： ```php WebView21.Navigate(\"https://www.example.com\") ``` #### **2. MoveFocus** **功能说明**：将焦点设置到 WebView 控件。 **参数**：无。 **示例代码**： ```php WebView21.MoveFocus() ``` #### **3. LoadHtml** **功能说明**：加载指定的 HTML 内容字符串。 **参数**： `htmlContent` (String)：要加载的 HTML 内容。 **示例代码**： ```php WebView21.LoadHtml(\"<html><body><h1>Hello, World!</h1></body></html>\") ``` #### **4. AddObject** **功能说明**：将 COM 对象暴露给 JavaScript 端，允许通过 `window.chrome.webview.hostObjects.ObjName` 访问。 **参数**： `ObjName` (String)：在 JavaScript 中访问对象的名称。 `Object` (Object)：要暴露给 JavaScript 的 COM 对象。 `UseDeferredInvoke` (Boolean)：是否使用延迟调用。 **示例代码**： ```php WebView21.AddObject(\"myObject\", myCustomObject, False) ``` #### **5. RemoveObject** **功能说明**：移除之前通过 `AddObject` 方法暴露的 COM 对象。 **参数**： `ObjName` (String)：要移除的对象名称。 **示例代码**： ```php WebView21.RemoveObject(\"myObject\") ``` #### **6. AddScriptToExecuteOnDocumentCreated** **功能说明**：在页面加载时注入 JavaScript 代码。仅对下一个页面导航生效。 **参数**： `jsCode` (String)：要执行的 JavaScript 代码。 **示例代码**： ```php WebView21.AddScriptToExecuteOnDocumentCreated(\"console.log('Hello from injected script');\") ``` #### **7. AddWebResourceRequestedFilter** **功能说明**：设置 URL 过滤器，当匹配的 URL 请求发生时，会触发 `WebResourceRequested` 事件。 **参数**： `sFilter` (String)：URL 过滤器，可以使用通配符 `*` 和 `?`。 `FilterContext` (wv2WebResourceContext)：请求上下文，指定过滤器适用的资源类型。 **示例代码**： ```php WebView21.AddWebResourceRequestedFilter(\"https://www.example.com/*\", WebView2RequestContext.wv2WebResourceContextScript) ``` #### **8. RemoveWebResourceRequestedFilter** **功能说明**：移除之前通过 `AddWebResourceRequestedFilter` 设置的 URL 过滤器。 **参数**： `sFilter` (String)：要移除的过滤器。 `FilterContext` (wv2WebResourceContext)：请求上下文。 **示例代码**： ```php WebView21.RemoveWebResourceRequestedFilter(\"https://www.example.com/*\", WebView2RequestContext.wv2WebResourceContextScript) ``` #### **9. OpenDevToolsWindow** **功能说明**：打开开发者工具窗口，允许开发者进行调试。 **参数**：无。 **示例代码**： ```php WebView21.OpenDevToolsWindow() ``` #### **10. CallDevToolsProtocolMethod** **功能说明**：向开发者工具发送协议消息，用于调试操作。 **参数**： `MethodName` (String)：要调用的开发者工具协议方法名称。 `ParamsAsJson` (String)：以 JSON 格式提供的方法参数。 `CustomEventId` (Variant)：可选，用户自定义的事件 ID，用于事件响应。 **示例代码**： ```php WebView21.CallDevToolsProtocolMethod(\"Emulation.setScriptExecutionDisabled\", \"{\"\"value\"\":true}\") ``` #### **11. ExecuteScript** **功能说明**：执行 JavaScript 代码，但不等待结果返回，也不返回任何值。 **参数**： `jsCode` (String)：要执行的 JavaScript 代码。 **示例代码**： ```php WebView21.ExecuteScript(\"alert('Hello from WebView!')\") ``` #### **12. JsRun** **功能说明**：执行 JavaScript 函数，并等待结果返回。 **参数**： `FuncName` (String)：要执行的 JavaScript 函数名称。 `args()` (Variant)：可变参数，传递给 JavaScript 函数的参数。 **示例代码**： ```php Dim result As Variant result WebView21.JsRun(\"add\", 1, 2) MsgBox result ' 输出 3 ``` ### 下一步 如果这一部分没有问题，我将继续处理文档中的 **属性部分 (Properties)**。"},"/tbman/dev/03_Properties.html":{"title":"属性","content":" title: 属性 keywords: VB6/VBA, WebView2浏览器控件, 可做采集 desc: VB6/VBA可用的WebView2浏览器控件(可做采集) 感谢你的耐心！接下来是 **属性部分 (Properties)** 的文档内容。我将继续提供每个属性的功能说明、参数说明和示例代码。 ### **属性部分 (Properties)** #### **1. hWnd** **功能说明**：返回 WebView2 控件的窗口句柄 (HWND)，可以用于在其他地方嵌入或显示 WebView2 控件。 **参数**：无。 **示例代码**： ```php Dim hwnd As LongPtr hwnd WebView21.hWnd MsgBox \"WebView2 窗口句柄：\" & hwnd ``` #### **2. DocumentURL** **功能说明**：获取当前文档的 URL 地址。 **参数**：无。 **示例代码**： ```php Dim url As String url WebView21.DocumentURL MsgBox \"当前文档的 URL 是：\" & url ``` #### **3. DocumentTitle** **功能说明**：获取当前文档的标题。 **参数**：无。 **示例代码**： ```php Dim title As String title WebView21.DocumentTitle MsgBox \"当前文档的标题是：\" & title ``` #### **4. ZoomFactor** **功能说明**：获取或设置 WebView2 控件的缩放因子。例如，1.5 表示页面缩放 50%。 **参数**： `Value` (Double)：设置的缩放因子值。 **示例代码**： ```php ' 获取当前缩放因子 Dim zoom As Double zoom WebView21.ZoomFactor MsgBox \"当前缩放因子是：\" & zoom ' 设置新的缩放因子 WebView21.ZoomFactor 1.2 ``` #### **5. BrowserProcessId** **功能说明**：获取 WebView2 控件所使用的浏览器进程 ID。 **参数**：无。 **示例代码**： ```php Dim processId As Long processId WebView21.BrowserProcessId MsgBox \"浏览器进程 ID：\" & processId ``` #### **6. CanGoBack** **功能说明**：返回一个布尔值，指示是否可以使用 \"返回\" 功能（即是否有历史记录可以返回）。 **参数**：无。 **示例代码**： ```php If WebView21.CanGoBack Then MsgBox \"可以返回\" Else MsgBox \"没有历史记录可以返回\" End If ``` #### **7. CanGoForward** **功能说明**：返回一个布尔值，指示是否可以使用 \"前进\" 功能（即是否有历史记录可以前进）。 **参数**：无。 **示例代码**： ```php If WebView21.CanGoForward Then MsgBox \"可以前进\" Else MsgBox \"没有历史记录可以前进\" End If ``` #### **8. IsSuspended** **功能说明**：返回一个布尔值，指示 WebView2 是否处于暂停状态。 **参数**：无。 **示例代码**： ```php If WebView21.IsSuspended Then MsgBox \"WebView2 已暂停\" Else MsgBox \"WebView2 正在运行\" End If ``` #### **9. IsMuted** **功能说明**：获取或设置 WebView2 的音频是否被静音。只有在支持音频的 WebView2 中可用。 **参数**： `Value` (Boolean)：设置静音状态，`True` 为静音，`False` 为非静音。 **示例代码**： ```php ' 获取音频是否静音 If WebView21.IsMuted Then MsgBox \"音频已静音\" Else MsgBox \"音频未静音\" End If ' 设置静音 WebView21.IsMuted True ``` #### **10. SupportsSuspendResumeFeatures** **功能说明**：返回一个布尔值，指示 WebView2 是否支持暂停和恢复功能。 **参数**：无。 **示例代码**： ```php If WebView21.SupportsSuspendResumeFeatures Then MsgBox \"支持暂停/恢复功能\" Else MsgBox \"不支持暂停/恢复功能\" End If ``` #### **11. SupportsDownloadDialogFeatures** **功能说明**：返回一个布尔值，指示 WebView2 是否支持下载管理器对话框功能。 **参数**：无。 **示例代码**： ```php If WebView21.SupportsDownloadDialogFeatures Then MsgBox \"支持下载对话框功能\" Else MsgBox \"不支持下载对话框功能\" End If ``` #### **12. SupportsTaskManagerFeatures** **功能说明**：返回一个布尔值，指示 WebView2 是否支持任务管理器功能。 **参数**：无。 **示例代码**： ```php If WebView21.SupportsTaskManagerFeatures Then MsgBox \"支持任务管理器功能\" Else MsgBox \"不支持任务管理器功能\" End If ``` ### 下一步 如果这部分没有问题，我将继续处理文档的 **控制功能部分 (Controls)**。"},"/tbman/dev/04_Controls.html":{"title":"控制","content":" title: 控制 keywords: VB6/VBA, WebView2浏览器控件, 可做采集 desc: VB6/VBA可用的WebView2浏览器控件(可做采集) 感谢你的耐心！接下来是 **控制功能部分 (Controls)** 的文档内容。我将继续提供每个控制功能的功能说明、参数说明和示例代码。 ### **控制功能部分 (Controls)** #### **1. SetVirtualHostNameToFolderMapping** **功能说明**：为指定的主机名创建虚拟文件夹映射，将指定主机名指向本地文件夹。可以通过此方法在 WebView2 中访问本地文件。 **参数**： `hostName` (String)：虚拟映射的主机名。 `folderPath` (String)：要映射的本地文件夹路径。 `accessKind` (wv2HostResourceAccessKind)：指定访问类型，默认允许访问。 **示例代码**： ```php WebView21.SetVirtualHostNameToFolderMapping(\"example.local\", \"C:\\MyLocalFolder\", wv2HostResourceAccessKind.wv2ResourceAllow) ``` #### **2. ClearVirtualHostNameToFolderMapping** **功能说明**：移除通过 `SetVirtualHostNameToFolderMapping` 方法设置的虚拟文件夹映射。 **参数**： `hostName` (String)：要移除映射的主机名。 **示例代码**： ```php WebView21.ClearVirtualHostNameToFolderMapping(\"example.local\") ``` #### **3. PrintToPdf** **功能说明**：将当前文档保存为 PDF 文件。支持设置页面方向、缩放、边距等选项。 **参数**： `outputPath` (String)：输出的 PDF 文件路径。 `Orientation` (wv2PrintOrientation)：页面的打印方向，`wv2PrintPortrait` 或 `wv2PrintLandscape`。 `ScaleFactor` (Variant)：缩放因子，指定打印时页面的缩放比例。 `PageWidth`、`PageHeight`、`MarginTop`、`MarginBottom`、`MarginLeft`、`MarginRight` (Variant)：页面大小和边距。 `ShouldPrintBackgrounds` (Boolean)：是否打印背景。 `ShouldPrintSelectionOnly` (Boolean)：是否仅打印选中的部分。 `ShouldPrintHeaderAndFooter` (Boolean)：是否打印页眉和页脚。 `HeaderTitle`、`FooterUri` (Variant)：页眉和页脚内容。 **示例代码**： ```php WebView21.PrintToPdf(\"C:\\Output\\document.pdf\", wv2PrintOrientation.wv2PrintPortrait, 1.0, 8.5, 11, 1, 1, 1, 1, False, False, True, \"My Document\", \"http://www.example.com\") ``` #### **4. Reload** **功能说明**：重新加载当前页面，相当于按下 F5 键。 **参数**：无。 **示例代码**： ```php WebView21.Reload() ``` #### **5. Suspend** **功能说明**：暂停 WebView2 的处理和渲染，适用于类似标签页的功能。 **参数**：无。 **示例代码**： ```php WebView21.Suspend() ``` #### **6. Resume** **功能说明**：恢复 WebView2 的处理和渲染。只有在调用过 `Suspend` 后才有效。 **参数**：无。 **示例代码**： ```php WebView21.Resume() ``` #### **7. OpenDefaultDownloadDialog** **功能说明**：打开 WebView2 的默认下载管理器对话框。只有在支持该功能的 WebView2 中可用。 **参数**：无。 **示例代码**： ```php WebView21.OpenDefaultDownloadDialog() ``` #### **8. CloseDefaultDownloadDialog** **功能说明**：关闭 WebView2 的默认下载管理器对话框。只有在支持该功能的 WebView2 中可用。 **参数**：无。 **示例代码**： ```php WebView21.CloseDefaultDownloadDialog() ``` #### **9. OpenTaskManagerWindow** **功能说明**：打开 WebView2 的内置任务管理器对话框，用于调试和监控 WebView2 的运行。 **参数**：无。 **示例代码**： ```php WebView21.OpenTaskManagerWindow() ``` #### **10. AreDefaultScriptDialogsEnabled** **功能说明**：控制是否启用默认的 JavaScript 脚本对话框（如 `alert()`）。如果禁用，开发者可以通过监听 `ScriptDialogOpening` 事件来自定义对话框。 **参数**： `Value` (Boolean)：设置为 `True` 启用默认对话框，`False` 禁用默认对话框。 **示例代码**： ```php WebView21.AreDefaultScriptDialogsEnabled False ``` #### **11. AreDevToolsEnabled** **功能说明**：控制是否允许通过右键菜单或快捷键打开开发者工具。设置为 `True` 时，用户可以通过右键或快捷键打开 DevTools。 **参数**： `Value` (Boolean)：设置为 `True` 启用 DevTools，`False` 禁用 DevTools。 **示例代码**： ```php WebView21.AreDevToolsEnabled True ``` ### 下一步 如果这些内容没有问题，我将继续处理文档的 **功能控制部分 (Feature Controls)**，包括一些其他控制和配置项。"},"/tbman/dev/05_FeatureControls.html":{"title":"功能","content":" title: 功能 keywords: VB6/VBA, WebView2浏览器控件, 可做采集 desc: VB6/VBA可用的WebView2浏览器控件(可做采集) 感谢你的耐心！接下来是 **功能控制部分 (Feature Controls)** 的文档内容。我将继续提供每个控制功能的功能说明、参数说明和示例代码。 ### **功能控制部分 (Feature Controls)** #### **1. IsScriptEnabled** **功能说明**：获取或设置是否启用 WebView2 中的 JavaScript。设置为 `False` 时，WebView2 将禁用 JavaScript 的执行。 **参数**： `Value` (Boolean)：设置为 `True` 启用 JavaScript，`False` 禁用 JavaScript。 **示例代码**： ```php ' 禁用 JavaScript 执行 WebView21.IsScriptEnabled False ' 启用 JavaScript 执行 WebView21.IsScriptEnabled True ``` #### **2. IsWebMessageEnabled** **功能说明**：控制是否启用 `PostWebMessage` 功能，使 WebView2 可以与 JavaScript 端进行消息传递。设置为 `True` 启用消息传递。 **参数**： `Value` (Boolean)：设置为 `True` 启用消息传递，`False` 禁用消息传递。 **示例代码**： ```php ' 启用 WebMessage 功能 WebView21.IsWebMessageEnabled True ' 禁用 WebMessage 功能 WebView21.IsWebMessageEnabled False ``` #### **3. AreHostObjectsAllowed** **功能说明**：控制是否允许在 WebView2 中暴露宿主对象。启用此功能后，JavaScript 可以通过 `chrome.webview.hostObjects` 访问宿主对象。 **参数**： `Value` (Boolean)：设置为 `True` 允许暴露宿主对象，`False` 禁止暴露宿主对象。 **示例代码**： ```php ' 允许暴露宿主对象 WebView21.AreHostObjectsAllowed True ' 禁止暴露宿主对象 WebView21.AreHostObjectsAllowed False ``` #### **4. IsZoomControlEnabled** **功能说明**：控制是否允许用户通过快捷键（Ctrl + 鼠标滚轮、Ctrl + 加号、Ctrl + 减号）来调整页面缩放。设置为 `False` 时，禁用该功能。 **参数**： `Value` (Boolean)：设置为 `True` 启用缩放控制，`False` 禁用缩放控制。 **示例代码**： ```php ' 启用缩放控制 WebView21.IsZoomControlEnabled True ' 禁用缩放控制 WebView21.IsZoomControlEnabled False ``` #### **5. IsBuiltInErrorPageEnabled** **功能说明**：控制是否启用 WebView2 内置的错误页面（如 404 页面）。如果禁用该功能，WebView2 会显示空白页面或开发者提供的错误页面。 **参数**： `Value` (Boolean)：设置为 `True` 启用内置错误页面，`False` 禁用内置错误页面。 **示例代码**： ```php ' 启用内置错误页面 WebView21.IsBuiltInErrorPageEnabled True ' 禁用内置错误页面 WebView21.IsBuiltInErrorPageEnabled False ``` #### **6. SupportsAcceleratorKeysFeatures** **功能说明**：返回一个布尔值，指示 WebView2 是否支持加速键功能（如 F5 刷新）。如果返回 `True`，表示 WebView2 支持加速键。 **参数**：无。 **示例代码**： ```php If WebView21.SupportsAcceleratorKeysFeatures Then MsgBox \"支持加速键功能\" Else MsgBox \"不支持加速键功能\" End If ``` #### **7. IsPasswordAutoSaveEnabled** **功能说明**：控制是否启用自动保存密码功能。如果启用，WebView2 会自动保存和填充表单中的密码信息。 **参数**： `Value` (Boolean)：设置为 `True` 启用密码自动保存，`False` 禁用该功能。 **示例代码**： ```php ' 启用密码自动保存 WebView21.IsPasswordAutoSaveEnabled True ' 禁用密码自动保存 WebView21.IsPasswordAutoSaveEnabled False ``` #### **8. IsGeneralAutoFillEnabled** **功能说明**：控制是否启用自动填充功能。如果启用，WebView2 会自动填充表单中的信息（如用户名、地址等）。 **参数**： `Value` (Boolean)：设置为 `True` 启用表单自动填充，`False` 禁用该功能。 **示例代码**： ```php ' 启用表单自动填充 WebView21.IsGeneralAutoFillEnabled True ' 禁用表单自动填充 WebView21.IsGeneralAutoFillEnabled False ``` #### **9. IsPinchZoomEnabled** **功能说明**：控制是否启用触摸设备上的捏合缩放功能。启用后，用户可以使用捏合手势来放大或缩小页面。 **参数**： `Value` (Boolean)：设置为 `True` 启用捏合缩放，`False` 禁用捏合缩放。 **示例代码**： ```php ' 启用捏合缩放 WebView21.IsPinchZoomEnabled True ' 禁用捏合缩放 WebView21.IsPinchZoomEnabled False ``` #### **10. IsSwipeNavigationEnabled** **功能说明**：控制是否启用触摸设备上的滑动导航功能。启用后，用户可以通过滑动手势进行页面前进或后退。 **参数**： `Value` (Boolean)：设置为 `True` 启用滑动导航，`False` 禁用滑动导航。 **示例代码**： ```php ' 启用滑动导航 WebView21.IsSwipeNavigationEnabled True ' 禁用滑动导航 WebView21.IsSwipeNavigationEnabled False ``` ### 下一步 如果这些功能控制部分没有问题，我会整理文档并准备最终的输出。如果你有其他问题或需要进一步的帮助，请告诉我！"},"/tbman/dev/06_DeveloperTools.html":{"title":"开发者调试","content":" title: 开发者调试 keywords: VB6/VBA, WebView2浏览器控件, 可做采集 desc: VB6/VBA可用的WebView2浏览器控件(可做采集) 非常感谢你的耐心！接下来是 **开发者工具与调试功能部分 (Developer Tools and Debugging Features)** 的文档内容。 ### **开发者工具与调试功能部分 (Developer Tools and Debugging Features)** #### **1. JsAsyncResult** **功能说明**：当 `JsRunAsync` 函数执行完成时，该事件会被触发。它提供了 JavaScript 执行结果的异步返回，可以通过 `Token` 来区分不同的调用。 **参数**： `Result` (Variant)：JavaScript 执行结果，通常是返回的值。 `Token` (LongLong)：调用时传递的唯一标识符，便于标识不同的异步请求。 `ErrString` (String)：错误信息（如果发生错误）。 **示例代码**： ```php Private Sub WebView21_JsAsyncResult(ByVal Result As Variant, Token As LongLong, ErrString As String) If ErrString \"\" Then MsgBox \"JavaScript 执行结果：\" & Result Else MsgBox \"JavaScript 错误：\" & ErrString End If End Sub ``` #### **2. JsMessage** **功能说明**：当 JavaScript 端通过 `window.chrome.webview.postMessage(...)` 发送消息时，`JsMessage` 事件会触发。此功能需要启用 `IsWebMessageEnabled`。 **参数**： `Message` (Variant)：来自 JavaScript 的消息内容，可以是任意类型的数据。 **示例代码**： ```php Private Sub WebView21_JsMessage(ByVal Message As Variant) MsgBox \"收到来自 JavaScript 的消息：\" & Message End Sub ``` #### **3. DevToolsProtocolResponse** **功能说明**：当通过 `CallDevToolsProtocolMethod` 调用开发者工具协议方法时，`DevToolsProtocolResponse` 事件会接收到方法的响应。 **参数**： `CustomEventId` (Variant)：自定义的事件 ID，用于关联响应。 `JsonResponse` (String)：开发者工具协议方法的 JSON 响应。 **示例代码**： ```php Private Sub WebView21_DevToolsProtocolResponse(ByVal CustomEventId As Variant, ByVal JsonResponse As String) MsgBox \"DevTools 响应：\" & JsonResponse End Sub ``` #### **4. OpenDevToolsWindow** **功能说明**：打开 WebView2 的开发者工具窗口。可以用于调试和查看页面内部内容。 **参数**：无。 **示例代码**： ```php WebView21.OpenDevToolsWindow() ``` #### **5. CallDevToolsProtocolMethod** **功能说明**：通过调用 WebView2 的开发者工具协议方法来与浏览器进行交互。例如，可以禁用脚本执行、模拟设备环境等。 **参数**： `MethodName` (String)：协议方法名称（如 `Emulation.setScriptExecutionDisabled`）。 `ParamsAsJson` (String)：以 JSON 格式传递的参数。 `CustomEventId` (Variant)：可选的自定义事件 ID，用于关联响应。 **示例代码**： ```php WebView21.CallDevToolsProtocolMethod(\"Emulation.setScriptExecutionDisabled\", \"{\"\"value\"\":true}\") ``` #### **6. JsRunAsync** **功能说明**：异步执行 JavaScript 代码，并返回一个唯一的 `Token` 来标识该异步执行。执行完成后，`JsAsyncResult` 事件会触发返回结果。 **参数**： `FuncName` (String)：要执行的 JavaScript 函数名称。 `args()` (Variant)：可变参数，传递给 JavaScript 函数的参数。 **示例代码**： ```php Dim Token As LongLong Token WebView21.JsRunAsync(\"myFunction\", \"param1\", \"param2\") MsgBox \"异步调用的 Token：\" & Token ``` #### **7. JsRun** **功能说明**：执行 JavaScript 函数并等待结果返回。适用于需要同步返回结果的情况。 **参数**： `FuncName` (String)：要执行的 JavaScript 函数名称。 `args()` (Variant)：可变参数，传递给 JavaScript 函数的参数。 **示例代码**： ```php Dim result As Variant result WebView21.JsRun(\"sum\", 5, 10) MsgBox \"执行结果：\" & result ' 输出 15 ``` ### 下一步 这部分是 WebView2 的开发者工具和调试功能的介绍。如果这一部分没有问题，我将整理并提供最终的完整文档。"},"/tbman/README_EN.html":{"title":"TBMAN ✨ – A Rapid Development Toolkit for TwinBasic Developers","content":"# TBMAN ✨ – A Rapid Development Toolkit for TwinBasic Developers ## ✨ What is TBMAN? TBMAN is a rapid development toolkit designed for TwinBasic developers. It defines a series of comprehensive functions and objects to reduce the amount of code developers need to write and improve reusability, enabling them to complete their projects faster and more efficiently. This project offers practical tools and continues to expand and upgrade. ⚡ The project originates from a VB6 library named vbman, which is a rapid server framework based on VB6. It is currently free to use but not open source. For more details, refer to the original project link: [✔️ VBMAN: A Rapid Server Framework Based on VB6](https://vb6.pro/vbman) ## 💌 Why Choose TBMAN? ### 📚 Advantage 1: Lower Development Costs TBMAN automates many development tasks by defining and integrating numerous general purpose functions, significantly reducing the time spent writing repetitive code. ### 🛠️ Advantage 2: Improved Reusability The design of TBMAN’s framework considers diverse application scenarios, allowing it to adapt quickly to different projects. ### 🔧 Advantage 3: Continuous Expansion TBMAN is built with a modular and component based design, enabling unlimited extensions and Will bring more efficient tools. ## ⚡ Installation and Usage **Installation** 1. Download the TBMAN package from the project homepage, and import the `TBMANLIB_*.twinpack` file from the `build` directory into your project. 2. Alternatively, you can directly include `TBMANLIB` in your project using the package manager in the TwinBasic IDE **(recommended)**. **Usage** Refer to the demo source code or read the documentation at [https://doc.twinbasic.com.cn/](https://doc.twinbasic.com.cn/). ## 🕵️‍♂️ Feature List ### Key Features 1. 🌐 **Web Utility Functions**: Supports rapid message parsing, HTTP request handling, and more. 2. 📊 **Data Operation Interfaces**: Provides consistent and practical data input/output interfaces. 3. 💡 **Intelligent Tools**: Automates code generation, reducing development difficulty(I am thinking...). ## 🏆 Focused and Comprehensive Core Features"},"/tbman/start/ChangeLog.html":{"title":"更新日志","content":" title: 更新日志 keywords: VB6/VBA, WebView2浏览器控件, 可做采集 desc: VB6/VBA可用的WebView2浏览器控件(可做采集) ### 2024 12 07 v1.0.7 [+] cHttpClient ### 2024 12 07 v1.0.0 Publish"},"/tbman/start/Install.html":{"title":"安装指引","content":" title: 安装指引 keywords: VB6/VBA, WebView2浏览器控件, 可做采集 desc: VB6/VBA可用的WebView2浏览器控件(可做采集) ### 下载组件🎁 暂时没有时间写详细安装手册，直接下载组件使用吧！ 🔗 **立即体验**：[点击这里下载 tbman](https://github.com/woeoio/tbman) ### 自带基础示例 [点击这里下载 示例](https://github.com/woeoio/tbman)"},"/tbman/start/KnownIssues.html":{"title":"已知问题","content":" title: 已知问题 keywords: VB6/VBA, WebView2浏览器控件, 可做采集 desc: VB6/VBA可用的WebView2浏览器控件(可做采集) 暂无编写..."},"/tbman/dev/07_AdvancedSettings.html":{"title":"高级设置","content":" title: 高级设置 keywords: VB6/VBA, WebView2浏览器控件, 可做采集 desc: VB6/VBA可用的WebView2浏览器控件(可做采集) 感谢你的耐心！现在是 **控制功能与高级设置部分 (Control Features & Advanced Settings)** 的文档内容。 ### **控制功能与高级设置部分 (Control Features & Advanced Settings)** #### **1. AreDefaultContextMenusEnabled** **功能说明**：控制是否启用默认的上下文菜单（右键菜单）。如果禁用，可以通过 `UserContextMenu` 事件来自定义右键菜单。 **参数**： `Value` (Boolean)：设置为 `True` 启用默认上下文菜单，`False` 禁用默认上下文菜单。 **示例代码**： ```php ' 禁用默认上下文菜单 WebView21.AreDefaultContextMenusEnabled False ' 启用默认上下文菜单 WebView21.AreDefaultContextMenusEnabled True ``` #### **2. AreBrowserAcceleratorKeysEnabled** **功能说明**：控制是否启用浏览器加速键（如 F5 刷新、Ctrl+T 新标签页）。启用时，用户可以使用这些快捷键进行常见操作。 **参数**： `Value` (Boolean)：设置为 `True` 启用浏览器加速键，`False` 禁用加速键。 **示例代码**： ```php ' 禁用浏览器加速键 WebView21.AreBrowserAcceleratorKeysEnabled False ' 启用浏览器加速键 WebView21.AreBrowserAcceleratorKeysEnabled True ``` #### **3. SupportsPdfFeatures** **功能说明**：返回一个布尔值，指示 WebView2 是否支持 PDF 功能。启用时，WebView2 可以直接展示 PDF 文件。 **参数**：无。 **示例代码**： ```php If WebView21.SupportsPdfFeatures Then MsgBox \"支持 PDF 功能\" Else MsgBox \"不支持 PDF 功能\" End If ``` #### **4. IsPinchZoomEnabled** **功能说明**：控制是否启用触摸设备上的捏合缩放功能。启用后，用户可以通过捏合手势进行页面缩放。 **参数**： `Value` (Boolean)：设置为 `True` 启用捏合缩放，`False` 禁用捏合缩放。 **示例代码**： ```php ' 启用捏合缩放 WebView21.IsPinchZoomEnabled True ' 禁用捏合缩放 WebView21.IsPinchZoomEnabled False ``` #### **5. SupportsAutoFillFeatures** **功能说明**：返回一个布尔值，指示 WebView2 是否支持自动填充功能。如果返回 `True`，表示 WebView2 支持自动填充（如自动填写表单中的用户名和密码）。 **参数**：无。 **示例代码**： ```php If WebView21.SupportsAutoFillFeatures Then MsgBox \"支持自动填充功能\" Else MsgBox \"不支持自动填充功能\" End If ``` #### **6. AreHostObjectsAllowed** **功能说明**：控制是否允许 WebView2 使用宿主对象（如 COM 对象）。如果设置为 `True`，JavaScript 可以访问和调用宿主对象的方法。 **参数**： `Value` (Boolean)：设置为 `True` 允许使用宿主对象，`False` 禁止使用宿主对象。 **示例代码**： ```php ' 启用宿主对象 WebView21.AreHostObjectsAllowed True ' 禁用宿主对象 WebView21.AreHostObjectsAllowed False ``` #### **7. SupportsFolderMappingFeatures** **功能说明**：返回一个布尔值，指示 WebView2 是否支持文件夹映射功能。如果返回 `True`，则可以使用 `SetVirtualHostNameToFolderMapping` 设置主机名到文件夹的映射。 **参数**：无。 **示例代码**： ```php If WebView21.SupportsFolderMappingFeatures Then MsgBox \"支持文件夹映射功能\" Else MsgBox \"不支持文件夹映射功能\" End If ``` #### **8. IsStatusBarEnabled** **功能说明**：控制是否启用 WebView2 的状态栏。启用时，WebView2 会显示状态栏，用于显示页面状态或加载进度等信息。 **参数**： `Value` (Boolean)：设置为 `True` 启用状态栏，`False` 禁用状态栏。 **示例代码**： ```php ' 启用状态栏 WebView21.IsStatusBarEnabled True ' 禁用状态栏 WebView21.IsStatusBarEnabled False ``` #### **9. SupportsTaskManagerFeatures** **功能说明**：返回一个布尔值，指示 WebView2 是否支持任务管理器功能。如果返回 `True`，则可以通过 `OpenTaskManagerWindow` 打开 WebView2 的内置任务管理器。 **参数**：无。 **示例代码**： ```php If WebView21.SupportsTaskManagerFeatures Then MsgBox \"支持任务管理器功能\" Else MsgBox \"不支持任务管理器功能\" End If ``` #### **10. SupportsAcceleratorKeysFeatures** **功能说明**：返回一个布尔值，指示 WebView2 是否支持浏览器加速键功能（如 F5 刷新、Ctrl+T 新标签页等）。 **参数**：无。 **示例代码**： ```php If WebView21.SupportsAcceleratorKeysFeatures Then MsgBox \"支持加速键功能\" Else MsgBox \"不支持加速键功能\" End If ``` ### 下一步 这部分是 WebView2 控制功能和高级设置的介绍。如果这部分没有问题，我将进行最后的文档整理并准备最终的输出。"},"/tbman/dev/08_OtherFeatures.html":{"title":"其他功能","content":" title: 其他功能 keywords: VB6/VBA, WebView2浏览器控件, 可做采集 desc: VB6/VBA可用的WebView2浏览器控件(可做采集) 非常感谢你的耐心！我们已完成了大部分文档内容。接下来是 **总结与其他功能部分 (Summary & Other Features)** 的文档内容。 ### **总结与其他功能部分 (Summary & Other Features)** #### **1. UserContextMenu** **功能说明**：当用户右击 WebView2 控件时触发该事件。如果禁用了默认上下文菜单 (`AreDefaultContextMenusEnabled False`)，则可以通过此事件自定义右键菜单。 **参数**： `X` (Single)：右键点击时的 X 坐标。 `Y` (Single)：右键点击时的 Y 坐标。 **示例代码**： ```php Private Sub WebView21_UserContextMenu(X As Single, Y As Single) MsgBox \"用户右键点击位置：X \" & X & \", Y \" & Y End Sub ``` #### **2. ScriptDialogOpening** **功能说明**：当 `AreDefaultScriptDialogsEnabled` 设置为 `False` 时，JavaScript 中的 `alert()`, `confirm()`, `prompt()` 等默认对话框会被拦截，并触发该事件。可以通过此事件自定义对话框。 **参数**： `ScriptDialogKind` (wv2ScriptDialogKind)：脚本对话框的类型（如 `alert`、`confirm` 等）。 `Accept` (ByRef Boolean)：设置为 `True` 可接受对话框，`False` 可拒绝对话框。 `ResultText` (String)：用于接收用户输入的文本。 `URI` (String)：触发对话框的 URL。 `Message` (String)：对话框中的消息。 `DefaultText` (String)：对话框中的默认文本。 **示例代码**： ```php Private Sub WebView21_ScriptDialogOpening(ByVal ScriptDialogKind As wv2ScriptDialogKind, ByRef Accept As Boolean, ByVal ResultText As String, ByVal URI As String, ByVal Message As String, ByVal DefaultText As String) MsgBox \"自定义脚本对话框: \" & Message Accept True ' 接受对话框 End Sub ``` #### **3. SuspendCompleted** **功能说明**：在调用 `Suspend` 方法成功后触发的事件，表示 WebView2 已成功暂停其处理和渲染。 **参数**：无。 **示例代码**： ```php Private Sub WebView21_SuspendCompleted() MsgBox \"WebView2 已成功暂停\" End Sub ``` #### **4. SuspendFailed** **功能说明**：在调用 `Suspend` 方法失败时触发的事件。 **参数**：无。 **示例代码**： ```php Private Sub WebView21_SuspendFailed() MsgBox \"WebView2 暂停失败\" End Sub ``` #### **5. NewWindowRequested** **功能说明**：当 WebView2 尝试打开一个新窗口时触发此事件。通过设置 `IsHandled True`，可以阻止 WebView2 默认行为，改为自定义窗口打开。 **参数**： `IsUserInitiated` (Boolean)：是否为用户触发。 `IsHandled` (ByRef Boolean)：如果设置为 `True`，则 WebView2 不会打开新窗口。 `Uri` (String)：请求的新 URL。 `HasPosition`、`HasSize`、`Left`、`Top`、`Width`、`Height` (Long)：新窗口的位置和大小。 `ShouldDisplayMenuBar`、`ShouldDisplayStatus`、`ShouldDisplayToolbar`、`ShouldDisplayScrollBars` (Long)：新窗口的功能设置。 **示例代码**： ```php Private Sub WebView21_NewWindowRequested(ByVal IsUserInitiated As Boolean, ByRef IsHandled As Boolean, ByVal Uri As String, ByVal HasPosition As Long, ByVal HasSize As Long, ByVal Left As Long, ByVal Top As Long, ByVal Width As Long, ByVal Height As Long, ByVal ShouldDisplayMenuBar As Long, ByVal ShouldDisplayStatus As Long, ByVal ShouldDisplayToolbar As Long, ByVal ShouldDisplayScrollBars As Long) MsgBox \"新窗口请求: \" & Uri IsHandled True ' 阻止默认打开新窗口 End Sub ``` #### **6. DownloadStarting** **功能说明**：在用户点击下载链接时触发此事件。可以在此事件中修改下载路径或取消下载。 **参数**： `ResultFilePath` (ByRef String)：下载的目标文件路径。 `Cancel` (ByRef Boolean)：设置为 `True` 可取消下载。 `Handled` (ByRef Boolean)：设置为 `True` 处理下载，`False` 使用默认行为。 **示例代码**： ```php Private Sub WebView21_DownloadStarting(ByRef ResultFilePath As String, ByRef Cancel As Boolean, ByRef Handled As Boolean) MsgBox \"下载开始，目标文件路径: \" & ResultFilePath ' 可修改文件路径或取消下载 ResultFilePath \"C:\\NewPath\\DownloadedFile.exe\" Cancel False ' 允许下载继续 Handled True ' 处理了下载 End Sub ``` ### 最后整理与输出 所有内容已经整理完毕！文档涵盖了事件、方法、属性、控制功能、开发者工具、调试功能和其他特性等方面，已完整完成。 **接下来的步骤**： 我会将整个文档整理成一个文件，并提供给你下载。 如果你需要，我可以继续压缩并提供文件下载链接。 如果没有其他问题，我将立即准备文件并通知你。"},"/tbman/dev/hello.html":{"title":"快速开始","content":" title: 快速开始 keywords: VB6/VBA, WebView2浏览器控件, 可做采集 desc: VB6/VBA可用的WebView2浏览器控件(可做采集) 请先看demo源码..."},"/tbman/dev/more.html":{"title":"敬请期待","content":" title: 敬请期待 keywords: VB6/VBA, WebView2浏览器控件, 可做采集 desc: VB6/VBA可用的WebView2浏览器控件(可做采集) 敬请期待..."},"/tbman/index.html":{"title":"TBMAN ","content":"# TBMAN TBMAN✨ – 为 TwinBasic 开发者提供的快速开发工具集合 ## ✨ 什么是 TBMAN？ TBMAN是一个面向 TwinBasic 开发者设计的快速开发工具集合，它自定义了一系列完善的函数和对象，目的是通过降低开发代码量和提高重复利用率，帮助开发者更快、更高效地完成他们的项目。这个项目提供了实用的工具，并持续扩充和升级。 ⚡ 该项目來源于 VB6 上的一个名叫vbman的库，它是基于 VB6 开发的快速服务器框架，现在免费使用，但未公开源。有关详情，可以参考原项目地址： [‍✔️ VBMAN：基于VB6的快速服务器框架](https://vb6.pro/vbman) ## 💡 为什么选择 TBMAN？ ### 📚 优势一：降低开发成本 TBMAN 通过定义并集成大量通用函数，提高了开发任务的自动化程度，大大降低你写重复代码的时间。 ### 🛠️ 优势二：提高重复利用率 TBMAN 的框架设计同时考虑到应用场景的多样性，使其可以快速适配到不同项目。 ### 🔧 优势三：持续扩充 TBMAN 采用构件化和模块化设计，可进行无界制的扩充，将会带来更多高效工具。 ## ⚡安装和使用 **安装** 项目开源地址：[https://github.com/woeoio/tbman](https://github.com/woeoio/tbman) 1. 从项目地址下载 TBMAN 文件包, 把 build 目录下的 TBMANLIB_*.twinpack 文件导入你的项目。 2. 另外一个可选方式, 是直接从 twinbasic ide 的 包管理器 引入 TBMANLIB 到项目 `推荐`。 **使用** 参考demo源代码，或者阅读此文档 ## 🕵️‍♂️ 功能列表 ### 重要功能 1. 🌐 **Web 实用函数集**：支持快速消息解析，HTTP 请求处理等。 2. 📊 **数据操作接口**：提供一致和实用的数据进出接口。 3. 💡 **智能化工具**：自动化代码生成，降低开发难度（思考中）。 ## 🏆 重点精心核心核完善集 ... ## 💌 捐赠本项目 如果本项目对你有帮助, 欢迎捐赠, 鼓励迭代发展! <div id \"big_btn_wrapper\"> <a class \"btn\" href \"/tbman/about/Donate.html\">立即打赏</a> </div> ## 🕵️‍♂️ 加入我们一起交流 <div> 欢迎入群： 788160802 <a href \"http://qm.qq.com/cgi bin/qm/qr?_wv 1027&k edaLl 56q2E9PBRuBEZEBwV wvVaEmrz&authKey 0KAufrkYd6U5SsjCqj86o42U9ifEs%2FIYIU8042W4iI8l%2FvqqBdkU64VXyHLpwt4h&noverify 0&group_code 788160802\" target \"_blank\"> 点击链接加入群聊【TwinBasic开发交流】 </a> </div>"}}